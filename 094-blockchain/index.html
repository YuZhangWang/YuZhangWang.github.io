<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>基于区块链采用Python实现的银行供应链金融服务 | YuZhangWang的领域</title><meta name="author" content="YuZhangWang"><meta name="copyright" content="YuZhangWang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、项目主要内容据新华社2020年10月25日晚消息，中共中央政治局2020年10月24日下午就区块链技术发展现状和趋势进行第十八次集体学习。中共中央总书记习近平在主持学习时强调，区块链技术的集成应用在新的技术革新和产业变革中起着重要作用。 随后“什么是区块链”、“区块链有什么用”、“怎么掌握区块链”这几个问题响不绝耳。这里尽量用通俗易懂的语句回答这些问题，期望即使是从没接触过区块链的人也能搞懂这">
<meta property="og:type" content="article">
<meta property="og:title" content="基于区块链采用Python实现的银行供应链金融服务">
<meta property="og:url" content="https://yuzhang.wang/094-blockchain/index.html">
<meta property="og:site_name" content="YuZhangWang的领域">
<meta property="og:description" content="一、项目主要内容据新华社2020年10月25日晚消息，中共中央政治局2020年10月24日下午就区块链技术发展现状和趋势进行第十八次集体学习。中共中央总书记习近平在主持学习时强调，区块链技术的集成应用在新的技术革新和产业变革中起着重要作用。 随后“什么是区块链”、“区块链有什么用”、“怎么掌握区块链”这几个问题响不绝耳。这里尽量用通俗易懂的语句回答这些问题，期望即使是从没接触过区块链的人也能搞懂这">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135010.png">
<meta property="article:published_time" content="2021-06-30T04:59:04.000Z">
<meta property="article:modified_time" content="2022-08-06T21:23:07.042Z">
<meta property="article:author" content="YuZhangWang">
<meta property="article:tag" content="MacOS">
<meta property="article:tag" content="黑苹果">
<meta property="article:tag" content="Ubuntu">
<meta property="article:tag" content="区块链">
<meta property="article:tag" content="创新">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135010.png"><link rel="shortcut icon" href="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202210171416164.png"><link rel="canonical" href="https://yuzhang.wang/094-blockchain/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?2ed9ec904657094072d5645542b35a76";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: {"limitDay":30,"position":"top","messagePrev":"距离上次更新已经过去","messageNext":"天,文章内容可能与实际操作有一定出入"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":666},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":500,"languages":{"author":"作者: YuZhangWang","link":"链接: ","source":"来源: YuZhangWang的领域","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '基于区块链采用Python实现的银行供应链金融服务',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-07 05:23:07'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script src="https://myhkw.cn/player/js/jquery.min.js" type="text/javascript"></script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/font.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="YuZhangWang的领域" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202210171416164.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">134</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">262</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">22</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/cinemas/"><i class="fa-fw fa fa-film"></i><span> 影视</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/"><i class="fa-fw fab fa-youtube"></i><span> 番剧</span></a></div><div class="menus_item"><a class="site-page" href="/natter/"><i class="fa-fw fa-sharp fa-solid fa-comments"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/albums/"><i class="fa-fw fa fa-camera"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/project/"><i class="fa-fw fa fa-coins"></i><span> 项目</span></a></div><div class="menus_item"><a class="site-page" href="/cv/"><i class="fa-fw fa-solid fa-file"></i><span> 简历</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-thumbs-up"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="YuZhangWang的领域"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202210171416164.png"/><span class="site-name">YuZhangWang的领域</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/cinemas/"><i class="fa-fw fa fa-film"></i><span> 影视</span></a></div><div class="menus_item"><a class="site-page" href="/bangumis/"><i class="fa-fw fab fa-youtube"></i><span> 番剧</span></a></div><div class="menus_item"><a class="site-page" href="/natter/"><i class="fa-fw fa-sharp fa-solid fa-comments"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/albums/"><i class="fa-fw fa fa-camera"></i><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/project/"><i class="fa-fw fa fa-coins"></i><span> 项目</span></a></div><div class="menus_item"><a class="site-page" href="/cv/"><i class="fa-fw fa-solid fa-file"></i><span> 简历</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-thumbs-up"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">基于区块链采用Python实现的银行供应链金融服务</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-30T04:59:04.000Z" title="发表于 2021-06-30 12:59:04">2021-06-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-06T21:23:07.042Z" title="更新于 2022-08-07 05:23:07">2022-08-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%A1%B9%E7%9B%AE%E5%B1%95%E7%A4%BA/">项目展示</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E6%9C%AF%E7%A0%94%E7%A9%B6/">学术研究</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">21.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>64分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="基于区块链采用Python实现的银行供应链金融服务"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="一、项目主要内容"><a href="#一、项目主要内容" class="headerlink" title="一、项目主要内容"></a>一、项目主要内容</h1><p>据新华社2020年10月25日晚消息，中共中央政治局2020年10月24日下午就区块链技术发展现状和趋势进行第十八次集体学习。中共中央总书记习近平在主持学习时强调，区块链技术的集成应用在新的技术革新和产业变革中起着重要作用。</p>
<p>随后“什么是区块链”、“区块链有什么用”、“怎么掌握区块链”这几个问题响不绝耳。这里尽量用通俗易懂的语句回答这些问题，期望即使是从没接触过区块链的人也能搞懂这项已经成为国家级现象的神奇技术。</p>
<h2 id="什么是区块链？"><a href="#什么是区块链？" class="headerlink" title="什么是区块链？"></a>什么是区块链？</h2><p>专业解释里，一般都会带上“分布式网络”、“密码学”、“共识算法”、“智能合约”这些有点晦涩的术语，这里打算举一个例子。</p>
<p>要理解区块链，首先要接受一个设定：有个账本，要记录的是一群人之间的公共账目（比如班费、物业费、公益捐款的收支），这个账本由大家一起来记账。选一个人，在账本的某一页，一行一行的记录明细，当一页记满后，大家都去核对账目，正确的话，大家签字认可这一页的所有账目。记满一页后，再选另一个人开始记接下来的一页。现在有意思的事情来了，新的一页首先要把上一页的一些摘要特征（比如页码、余额、人数、条数什么的…）抄写下来放在页首以供对照，免得前一页被改了或丢了还无据可查。然后，再一条条记账，记满一页后，核对、签名确认…依次反复。这样，账本的一页和一页之间就形成了“证据链”。</p>
<p>更重要的是，账本上已经签名确认的每一页，所有人都会一字不漏地复制一份，放到自己家里，以免少数人篡改、污损、丢失账目。这样，账本的每一页是一个“区块(Block)”，一页一页之间形成前后连贯的证据链，每个人之间构成了多点的网络，这就是“区块链”的概要原型了。这里面的关键点在于，这个账本一定是一群人的账，并不是一个人的账。如果是一个人的账，自己拿个小本本记就好了，为什么要整这么麻烦。就是因为这一群人互相之间并不完全信任，记账过程可能出纰漏，所以必须用这么繁琐的步骤，让大家平等参与，一起保证账目的准确和公允性，产生的结果大家保存，永远不会丢也不会错。</p>
<p>上面的举例看起来步骤繁琐，还要求每个人都一字不差地复刻和保存，那么就需要技术手段来帮助大家记账。这又回到技术环节，随着计算机科技的发展，无论是网络、密码学、数据结构、分布式算法等技术都趋于成熟，区块链领域把这些技术组合在一起，一揽子完成了从记账到分发到验证到保存的整个过程。运用技术服务整个群体，这就是神奇的区块链技术。</p>
<p>区块链有巨大的发展潜力，本身蕴含着极密集的技术含量，对技术有足够研究和把控，才能使自身发展不受外界影响和制约。区块链技术将会被用到与国计民生有关的广泛场景里，牵涉到许多人的财务和个人信息，甚至是金融行业、政务民生等关键领域的重要信息，重视技术和运作的安全可控，才能保护财务安全、信息安全，乃至社会安全。所以，当下国家给我们提出了明确的要求：“注意区块链技术发展现状和趋势，提高运用和管理区块链技术能力”，这样才能更好地建设网络强国、发展数字经济、助力经济社会发展。</p>
<p>我国产业界在区块链领域投入很早、力度很大，诸多大型金融企业、互联网公司、科技公司都在进行区块链研究，在过去几年中，已经逐步解决或接近解决了区块链领域的一系列核心问题，如性能、安全、易用性、合规等，在这个过程中也积累了大量的知识产权和专利。</p>
<p>我们重点发展的区块链领域是“联盟链”，联盟链和匿名的、有虚拟代币的“公有链”（诸如比特币、以太坊等）有极大不同，联盟链不发币不挖矿，摈弃了野蛮运作的弊端，能更规范、合法的运作，可有效服务于实体经济。</p>
<p>由微众银行、深圳市金融科技协会等国内机构共同发起成立的区块链联盟——金链盟，掌握多项核心技术，于2017年开源发布了以FISCO BCOS为代表的区块链底层平台和系列解决方案。这一系列开源项目都安全可控、性能优异、免费且易用，致力于服务实体经济，在大量关系国计民生的产业中已广泛落地，技术和模式得到了大量实际案例的验证。</p>
<p>另外值得一提的是，FISCO BCOS采用技术开源的路径加速行业发展，孵化拓展了国内最大和最活跃的行业生态社区，在推进中重视人才培养，在高校、社会、产业机构中培养了大量的区块链专业人才，帮助区块链技术和产业发展加速人才方面的突破。</p>
<p>区块链已经触达当下，更将影响未来，和一个具备无限潜力的趋势共同成长，现在，就是最好的时节。</p>
<h2 id="区块链原理"><a href="#区块链原理" class="headerlink" title="区块链原理"></a>区块链原理</h2><p>说到原理,需要解释以下几个概念:<strong>区块</strong>,<strong>哈希算法</strong>,<strong>公钥与私钥</strong>,<strong>时间戳</strong>,<strong>Merkle树</strong>。</p>
<p>首先,区块作为区块链的基本结构单元,由包含元数据的区块头和包含交易数据的区块主体构成。<br>区块头含三组数据,第一组用于链接前面的区块,索引来自父区块的哈希值数据。第二组与挖矿难度;用于工作量证明(PoW)的计数器,其名为Nonce;最后一组是Merkle数根数据,用来快速归纳校验区块中所有交易数据。</p>
<p>其二,哈希算法。这源于一个密码学的数学函数—-哈希函数。输入值为任意大小的字符串,输出值为固定大小的数,一般是十六进制的。长度为N的字符串,其复杂度为N的高阶无穷小。加密根据特定的字典(即哈希表)。而这里主要得力于加密的哈希函数,作为比特币交易的哈希函数一般要求以下三点:碰撞阻力(collision resistance),隐秘性(hiding),谜题友好(puzzle friendliness)。接着,大体地介绍这三个概念:</p>
<p>碰撞阻力:有哈希函数H,如果无法找到两个值x和y(即不存在两个值x,y),且x与y不等,使得H(x)=H(y),则称哈希函数H具有碰撞阻力。</p>
<p>隐秘性:已知哈希函数H(x)的输出值y,不可通过严密的逆推得到输入值x,这种特性称为隐秘性。这种加密也称不对称加密。</p>
<p>谜题友好:哈希函数H,其任意输入值x的位数记为n,假定k选自高阶最小熵分布,如果无法找到一个可行的方法,在比2^n小很多时间内找到x,保证(k||x)=y成立,那么称哈希函数H为谜题友好。</p>
<p>最后一点,(the last but not the least)Merk构。这个树结构以发明者拉尔夫 (Ralph Merkle)的名字命名。以下是这个树结构的示例图:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908142635.png" alt=""></p>
<p>如图所示,假设我们有很多这些数据区块两两分组,然后为每一组建立一个有两个哈希指针的数据结构,每个指针对应一个区块,这些数据结构就成了树的下一个层次。我们轮流将这些区块组成两两分组,为每一组建立一个包含每个区块组哈希指针的新的数据结构。以此类推,直到我们得到一个单一区块,即树根节点。最前面的哈希指针指向的值即为私钥,用户必须切记。</p>
<h2 id="一些区块有关的问题："><a href="#一些区块有关的问题：" class="headerlink" title="一些区块有关的问题："></a>一些区块有关的问题：</h2><p>这些问题,一部分是中本聪在创立区块链之前就注意到并且加以解决的,还有的是后人发现的。</p>
<h3 id="1-两类军问题"><a href="#1-两类军问题" class="headerlink" title="(1)两类军问题"></a>(1)两类军问题</h3><p>也被称为两军悖论,或者协同攻击问题。两个军队分隔很远,传递消息的信差可能在途中阵亡,或因军队距离不能在得到消息后及时回复,发送方也无法确认消息确实丢失的情形,导致不可能达到一致性。在分布式算法上,试图在异步系统和不可靠的通道上达成一致情形是可能的。因此对一致性的研究一般假设信道是可靠的,或非异步系统上系统上同步。总而言之,它是用来阐述在一个不可靠的通信链路上试图通过通信以达成一致是存在缺陷的和困难的悖论。</p>
<h3 id="2）拜占庭将军问题"><a href="#2）拜占庭将军问题" class="headerlink" title="(2）拜占庭将军问题"></a>(2）拜占庭将军问题</h3><p>问题的起源是这样的,拜占庭罗马帝国国土辽阔,为了防御敌人每个军队分隔很远,将军与将军之间只能靠信差传递消息。但军队中的叛徒和谋反者会影响信息传递,如何在不受叛徒影响下传递信息的问题就是拜占庭将军问题。举例, A为发布消息的总司令,B,C,D则为三个将军,其中有叛变者。 </p>
<p>如图:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908142727.png" alt=""></p>
<p>可以将数据列表,如下:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908142801.png" alt=""></p>
<p>可以看出,B就是叛徒</p>
<h3 id="3-女巫攻击"><a href="#3-女巫攻击" class="headerlink" title="(3)女巫攻击"></a>(3)女巫攻击</h3><p>大规模的p2p系统面临着有问题的和敌对的节点的威胁，为了应付这种威胁，很多系统采用了冗余。然而，如果一个有恶意的实体模仿了多个身份，他就可以控制系统的很大一部分，破坏了系统的冗余策略。我们把这种模仿多个身份的攻击定义为女巫攻击。</p>
<p>验证技术可用于防止Sybil攻击和消除伪装敌方实体。 本地实体可以基于中央权威来接受远程身份，其确保身份和实体之间的一对一对应，并且甚至可以提供反向查找。 身份可以直接或间接地验证。 在直接验证中，本地实体查询中央授权机构以验证远程标识。 在间接验证中，本地实体依赖于已经接受的身份，继而保证所讨论的远程身份的有效性。</p>
<p>基于身份的验证技术通常以匿名为代价提供问责制 ，这可能是一个不可取的折衷，特别是在希望允许无检查的信息交换和公开讨论敏感话题的在线论坛。 验证机构可以通过拒绝执行反向查找来尝试保持用户的匿名性，但是这种方法使验证机构成为攻击的主要目标。 或者，权威机构可以使用除了用户的真实身份的知识之外的一些机制 - 诸如验证未识别的人在特定地点和时间的物理存在 - 来实施在线身份和真实世界用户之间的一一对应。 </p>
<h2 id="去中心化的经济革命与区块链的前景："><a href="#去中心化的经济革命与区块链的前景：" class="headerlink" title="去中心化的经济革命与区块链的前景："></a>去中心化的经济革命与区块链的前景：</h2><h3 id="经济去中心化"><a href="#经济去中心化" class="headerlink" title="经济去中心化"></a>经济去中心化</h3><p>经济革命,它的核心就是去中心化。而区块链的发展前景必然联系与经济。</p>
<p>什么是去中心化?在一个分布有众多节点的系统中,每个节点都具有高度自治的特征。节点之间彼此可以自由连接,形成新的连接单元。任何一个节点都有可能成为阶段性的中心,但不具备强制性的控制功能节点与节点之间的影响,会通过网络形成非线性因果关系。这种开放式,扁平化,平等性的系统现象或结构,称之为去中心化。</p>
<p>中心化的意义在于控制,尤其是工业时代,人们将生产和工作都集中在一起,从而达到完全控制的目的。中心能够控制所有过程,保证准确无误。与此同时,也是它的致命缺点。</p>
<p>决断的权威,权力的垄断,必然导致腐败的滋生,小小的错误决断也会因此被放大,产生不可预计的结果。去中心化使得权威存在的必要越来越弱,正如中本聪所言”每个人都是中本聪”。</p>
<h3 id="赋予机器思考的力量"><a href="#赋予机器思考的力量" class="headerlink" title="赋予机器思考的力量"></a>赋予机器思考的力量</h3><p>2018年GTC上所展现的人工智能的应用也许在不久的将来就会完全实现(因为其中不少已经实现了)。</p>
<p>“AI并不是天方夜谭,它确实可以实现而许多已经呈现在我们眼前.” ———-黄仁勋。</p>
<p>将数据传入中心服务器有极大可能引起黑客攻击,数据窃取,和服务器瘫痪。但分布式的区块链技术可以完美解决,在拜占庭容错机制下,各个区块权力相当,黑客攻击难度大大提高,使得信息安全得到保障。</p>
<p>区块链前景———撕不毁的智能合约。</p>
<p>这样完全解决了法庭上”你认为,我认为”的争论,严格按照智能合约执行。但是智能合约的制定倒是需要各方面的专家一同讨论制定。</p>
<h2 id="国内国外区块链技术研究存在的问题与未来研究方向与方式"><a href="#国内国外区块链技术研究存在的问题与未来研究方向与方式" class="headerlink" title="国内国外区块链技术研究存在的问题与未来研究方向与方式"></a>国内国外区块链技术研究存在的问题与未来研究方向与方式</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题:"></a>问题:</h3><p>(1)理论研究落后于实际发展</p>
<p>(2)大多数研究都集中在比特币环境</p>
<p>(3)一些重要议题尚未涉及,缺少对处理性能,拓展性,集成性等主题的研究</p>
<h3 id="方向"><a href="#方向" class="headerlink" title="方向:"></a>方向:</h3><p>(1)可以拓展区块链研究的范围,尤其是空白领域如技术监管,漏洞检测,和应急反应,遭到攻击后的后果与责任负责,还有侧链,影子链,私有链等,都有待深入研究。</p>
<p>(2)可以加大关注在区块链技术在经济,社会生活中的应用前景。</p>
<h2 id="项目基于情况"><a href="#项目基于情况" class="headerlink" title="项目基于情况"></a>项目基于情况</h2><p>现有三家公司A、B和C,情况如下：</p>
<p>公司A规模大，信用良好，实力丰厚，有很大的风险承担的能力，拥有直接从银行等金融机构获得大笔融资的资格。</p>
<p>公司B、C规模相对较小，不能直接从银行金融机构获得大笔资金。</p>
<p>现有以下交易场景：</p>
<p>公司A向公司B订购一批货物；公司B生产这批货物，需要向公司C订购一批材料。</p>
<p>公司A现在资金短缺，向公司B签订一份一定数额的单据，承诺会给付公司B货款。这时，公司B可以用这份跟公司A签订的单据向银行贷款，凭借的是公司A的信用。并且，公司B有了公司A授权的信用，公司B能以同样的方式向公司C签订单据，公司C也可以凭借单据向银行贷款。</p>
<p>传统方法下，这样的流程需要非常复杂的授权、验证过程。</p>
<p>本项目基于腾讯微众银行开源的FISCOBCOS区块链平台，使用区块链技术高效地实现这样的信用传递过程，实现了基于区块链的供应链金融平台。</p>
<h1 id="二、项目实施情况总结"><a href="#二、项目实施情况总结" class="headerlink" title="二、项目实施情况总结"></a>二、项目实施情况总结</h1><h2 id="1-项目实施情况"><a href="#1-项目实施情况" class="headerlink" title="1.项目实施情况"></a>1.项目实施情况</h2><p>(1)本项目采用了链端作为后端的支持维护，容器为Ubuntu18.04 .5，区块链采用的是腾讯微众银行开源的FISCOBCOS区块链平台。此外，还用到了FISCO BCOS Python SDK，Flask 1.1和Python 3.6.3+来组成一个完善的后端，在项目的初期计划中，我们着重与理论研究，在代码实现上完成后端的搭建编写，链端逻辑算法的编写即可，在后期，采用了OC语言，实现了一个简易的iOSAPP完成前端数据的展现。</p>
<p>(2)实现了该区块链的供应链金融平台。控制台仲裁机构进行以下操作：</p>
<p>有银行bank1,受信公司A,公司B、C;</p>
<p>bank_1向受信公司A提供1000信用资产；</p>
<p>公司A向公司B转移500信用资产；</p>
<p>公司B用250信用资产向银行获取真实资金；</p>
<p>此时进行查询操作。</p>
<p>(3)后端API示例（使用Python SDK、Flask框架实现）:</p>
<p>后端每次收到请求时，都会先检查链上内容的更新，确保返回的是最新信息。</p>
<p>公司信息查询，根据公司名称获取相应信息：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908131639.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908131701.png" alt=""></p>
<p>单据查询，根据公司名称获取所有该公司参与的交易的单据：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908131720.png" alt=""></p>
<p>欠款查询，根据银行名称和受信公司名称，获取该银行向该受信公司授权的信用资产数额：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908131739.png" alt=""></p>
<h2 id="2-项目研究内容及方法的创新"><a href="#2-项目研究内容及方法的创新" class="headerlink" title="2.项目研究内容及方法的创新"></a>2.项目研究内容及方法的创新</h2><h3 id="项目研究内容"><a href="#项目研究内容" class="headerlink" title="项目研究内容"></a>项目研究内容</h3><p>从功能视角、系统视角、用户视角和开发视角，分别从逻辑层面、运行层面、使用层面和开发层面厘清代码架构和关键算法。</p>
<h4 id="1-功能视角"><a href="#1-功能视角" class="headerlink" title="(1)功能视角"></a>(1)功能视角</h4><p>在深入一份区块链底层代码之前，首先要通过其官网、技术文档、github wiki等渠道获取项目设计文档，了解其基本功能设计。</p>
<p>一般每个项目都会提供核心功能列表、总体架构图、功能模块图等介绍文档，通过这些介绍可以掌握项目基本功能。即使你真的找不到也不打紧，大部分区块链底层项目在功能设计层面的差异较小，核心功能模块也大致相同。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908131819.png" alt=""></p>
<p>以FISCO BCOS为例，基础层代码如下：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908131837.png" alt=""></p>
<p>核心层核心代码如下：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908131900.png" alt=""><br>接口层核心代码如下：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908131917.png" alt=""></p>
<h4 id="2-系统视角"><a href="#2-系统视角" class="headerlink" title="(2)系统视角"></a>(2)系统视角</h4><p>系统视角从整个区块链网络运行角度，关注区块链节点全生命周期所参与的系统行为。</p>
<p>关注点包括从敲下启动节点的命令开始，节点经历了哪些初始化环节，之后又是如何与其他节点建立点对点网络，以及完成分布式协作的。</p>
<p>由于不同区块链在部署架构上略有差异，系统运行方式也有所不同，但万变不离其宗，系统视角来看，每个区块链系统都要经历节点初始化、建立点对点网络、完成分布式交互的过程。</p>
<p>从系统视角看区块链，首先要关注初始化工作。以FISCO BCOS为例，区块链节点启动从main函数入口进入，通过libinitializer模块初始化并启动各模块，启动顺序如下：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132010.png" alt=""></p>
<p>通过启动顺序可以知道FISCO BCOS的一个重要特性——支持多群组账本，每个群组是一个独立的Ledger模块，每个Ledger具有独立的存储、同步、共识处理功能。</p>
<p>完成初始化工作同时，系统将会启动若干线程（或者进程、协程，原理类似），这些线程包括网络监听、共识、消息同步等，可以结合代码分析与系统命令查看运行节点配合确定有哪些关键线程，搞清楚关键线程的工作机制就可以基本掌握区块链系统运行机制。</p>
<p>以FISCO BCOS为例，节点启动之后的关键线程以及他们之间的关系如下：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132028.png" alt=""></p>
<p>初始化完成之后，网络模块的Host线程将根据配置列表，主动与其他节点建立连接，并且持续监听来自其他节点的连接；Sync线程开始相互发送区块高度，发现高度低于其他节点则开启下载逻辑；RPC与Channel线程等待客户端发送请求，将收到的交易塞入txpool；Sealer线程从txpool获取交易，Consensus线程则开始处理共识消息包。</p>
<p>如此，整个区块链系统有条不紊地运转，完成客户端请求与分布式协作。</p>
<h4 id="3-用户视角"><a href="#3-用户视角" class="headerlink" title="(3)用户视角"></a>(3)用户视角</h4><p>用户视角关注操作接口和交易生命周期，关注访问区块链的接口和协议设计、编解码方式、核心数据结构、错误码规范等，还会关注如何发送一笔交易到链上，交易在链上又经历了哪些处理流程，直到达成全网共识。</p>
<p>一般区块链底层项目都会给出交互协议的说明文档，通常实现包括JsonRPC、gRPC、Restful等不同类型的交互协议。</p>
<p>不同项目的交互接口会有所不同，但大都会包含发送交易、部署合约、调用合约、查看区块、查看交易以及回执、查看区块链状态等接口。不同项目的数据编码也会有所不同，有些采用Json，有些采用protobuf等。</p>
<p>当从技术文档中了解清楚交互协议、接口、编解码和错误码等设计细节之后，接下来最重要的是通过发送交易、部署合约、调用合约这些关键接口，对代码进行抽丝剥茧，贯穿交易整个生命周期，从而搞清楚区块链底层最核心的逻辑。</p>
<p>以FISCO BCOS为例，通过多个模块相互协作，完成交易整个生命周期的处理：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132045.png" alt=""></p>
<h4 id="4-开发视角"><a href="#4-开发视角" class="headerlink" title="(4)开发视角"></a>(4)开发视角</h4><p>开发视角关注的是整个代码工程，包括第三方依赖，源码模块之间的相互关系，单元测试框架和测试用例，编译和构建方式，持续集成和benchmark，以及如何参与社区源码贡献等等。</p>
<p>不同语言都有相应推荐的编译构建方式以及单测框架，通常在区块链项目源码目录可以快速定位到第三方依赖库，比如以cmake构建的C++项目有CmakeLists.txt文件，go项目有go.mod文件，rust项目有cargo.toml文件等。</p>
<p>以FISCO BCOS为例，从CmakeLists.txt可以看到依赖库包括：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132115.png" alt=""></p>
<p>项目核心源码包括fisco-bcos程序入口代码，以及libxxx的各模块代码，根据模块的名字可以快速识别其对应功能，这里也体现了一个项目源码质量的高低，高质量的代码应该是“代码即注释”。</p>
<p>单元测试代码在test目录，采用boost的单元测试框架，子目录unittests中单测代码与源码目录一一对应，非常容易找到源码对应的单元测试代码。</p>
<p>构建和持续集成工具代码在tools目录，子目录ci中维护了多个不同场景的持续集成用例，在github提交的每一个pr（pull request）都会触发这些持续集成用例，当且仅当每个用例成功通过方可允许合入pr。</p>
<p>具体实现方法如下:</p>
<h4 id="5-Python-API的安装"><a href="#5-Python-API的安装" class="headerlink" title="(5)Python API的安装"></a>(5)Python API的安装</h4><p>由于我们使用的是ubuntu，所以需要进行依赖软件问题的解决，这里先进行软件的安装，安装命令如下所示。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install -y zlib1g-dev libffi6 libffi-dev wget git</span><br></pre></td></tr></table></figure><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132245.png" alt=""></p>
<h4 id="6-API的安装"><a href="#6-API的安装" class="headerlink" title="(6)API的安装"></a>(6)API的安装</h4><p>我们使用git clone <a target="_blank" rel="noopener" href="https://gitee.com/FISCO-BCOS/python-sdk命令从Gitee上下载源码进行编译。">https://gitee.com/FISCO-BCOS/python-sdk命令从Gitee上下载源码进行编译。</a></p>
<h4 id="7-进入源码并且创建虚拟环境"><a href="#7-进入源码并且创建虚拟环境" class="headerlink" title="(7)进入源码并且创建虚拟环境"></a>(7)进入源码并且创建虚拟环境</h4><p>便于接下来用python实现调用链端并且实现交易，运行命令为<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd python-sdk &amp;&amp; bash init_env.sh -p</span><br><span class="line">source ~/.bashrc &amp;&amp; pyenv activate python-sdk &amp;&amp; pip install --upgrade pip</span><br></pre></td></tr></table></figure><br>激活虚拟环境成功如下图所示<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132340.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132351.png" alt=""></p>
<h4 id="8-区块链网络搭建"><a href="#8-区块链网络搭建" class="headerlink" title="(8)区块链网络搭建"></a>(8)区块链网络搭建</h4><p>在API接口部署完毕之后，我们就可以进行区块链网络的搭建，在这里我们在一个容器中部署四个节点的FISCO BCOS联盟。<br>首先用<code>sudo apt install -y openssl curl</code>命令解决ubuntu的依赖问题，便于接下来的操作。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132430.png" alt=""></p>
<h4 id="9-生成搭建工作"><a href="#9-生成搭建工作" class="headerlink" title="(9)生成搭建工作"></a>(9)生成搭建工作</h4><p>使用<code>cd ~ &amp;&amp; mkdir -p fisco &amp;&amp; cd fisco</code>进行目录创建步骤存放我们所需的源码，并使用命令下载节点的生成脚本以便于接下来的生成搭建工作，<code>curl-#LO https://github.com/FISCO-BCOS/FISCO-BCOS/releases/download/v2.7.2/build_chain.sh &amp;&amp; chmod u+x build_chain.sh</code></p>
<h4 id="10-生成FISCO链"><a href="#10-生成FISCO链" class="headerlink" title="(10)生成FISCO链"></a>(10)生成FISCO链</h4><p>在fisco目录下执行下面的指令，生成一条单群组4节点的FISCO链。 请确保机器的30300~30303，20200~20203，8545~8548端口没有被占用。<code>bash build_chain.sh -l 127.0.0.1:4 -p 30300,20200,8545</code><br>需要注意的是，其中-p选项指定起始端口，分别是p2p_port,channel_port,jsonrpc_port<br>出于安全性和易用性考虑，v2.3.0版本最新配置将listen_ip拆分成jsonrpc_listen_ip和channel_listen_ip，但仍保留对listen_ip的解析功能，为便于开发和体验，channel_listen_ip参考配置是 0.0.0.0 ，出于安全考虑，请根据实际业务网络情况，修改为安全的监听地址，如：内网IP或特定的外网IP。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132847.png" alt=""></p>
<h4 id="11-启动"><a href="#11-启动" class="headerlink" title="(11)启动"></a>(11)启动</h4><p>节点部署完毕之后，可以使用<code>bash nodes/127.0.0.1/start_all.sh</code>启动四个节点<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908132924.png" alt=""><br>在终端中，出现了以下的信息，说明四个节点部署成功并且启动成功</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">try to start node0</span><br><span class="line">try to start node1</span><br><span class="line">try to start node2</span><br><span class="line">try to start node3</span><br><span class="line">node1 start successfully</span><br><span class="line">node2 start successfully</span><br><span class="line">node0 start successfully</span><br><span class="line">node3 start successfully</span><br></pre></td></tr></table></figure>
<h4 id="12-进程检查"><a href="#12-进程检查" class="headerlink" title="(12)进程检查"></a>(12)进程检查</h4><p>然后执行ps -ef | grep -v grep | grep fisco-bcos进行进程检查<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133025.png" alt=""><br>我们可以看到，这路是四个进程在运行，说明四个阶段各自占用了端口并且没有被占用。</p>
<h4 id="13-节点实时运行状态检查"><a href="#13-节点实时运行状态检查" class="headerlink" title="(13)节点实时运行状态检查"></a>(13)节点实时运行状态检查</h4><p>之后执行tail -f nodes/127.0.0.1/node0/log/log*  | grep connected检查日志输出，在此命令中，以node0节点为例，检查该节点实时运行状态。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133108.png" alt=""><br>在这里我们可以看到该节点的状态信息源源不断输出，并且可以看出，该节点正在和其他三个节点相连。</p>
<h4 id="14-控制台部署"><a href="#14-控制台部署" class="headerlink" title="(14)控制台部署"></a>(14)控制台部署</h4><p>接下来是进行控制台的部署工作，在控制台链接FISCO BCOS节点，实现查询区块链状态、部署调用合约等功能，能够快速获取到所需要的信息。</p>
<p>首先我们需要解决依赖问题，也就是JDK的安装以及环境声明，因为FISCBCOS节点启动成功需要安装JDK8以上的版本，所以在这里我们使用JDK11，首先访问Oracle官网，下载JDK11源码压缩包，然后进行解压。我们选择/opt文件夹作为JDK11的储存位置。然后使用vim在/etc/profile文件中进行Java_Home等路径环境声明。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133139.png" alt=""><br>编写完成之后，我们使用<code>source /etc/profile</code>进行全局声明。使java环境部署成功，然后我们使用<code>java -version</code>来检测环境部署是否成功。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133219.png" alt=""></p>
<h4 id="15-配置控制台信息"><a href="#15-配置控制台信息" class="headerlink" title="(15)配置控制台信息"></a>(15)配置控制台信息</h4><p>使用<code>cp -r nodes/127.0.0.1/sdk/* console/conf/</code>来配置控制台信息，配置完成之后，就可以启动控制台。</p>
<h4 id="16-启动控制台"><a href="#16-启动控制台" class="headerlink" title="(16)启动控制台"></a>(16)启动控制台</h4><p>使用<code>cd ~/fisco/console &amp;&amp; bash start.sh</code>来启动控制台，可以看到控制台启动成功<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133322.png" alt=""></p>
<h4 id="17-WEBASE-Front节点的搭建"><a href="#17-WEBASE-Front节点的搭建" class="headerlink" title="(17)WEBASE-Front节点的搭建"></a>(17)WEBASE-Front节点的搭建</h4><p>然后进行WEBASE-Front节点的搭建，步骤和FISCO搭建类似，不进行过多的描述，启动成功之后如下图所示<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133522.png" alt=""></p>
<h4 id="18-检查节点进程"><a href="#18-检查节点进程" class="headerlink" title="(18)检查节点进程"></a>(18)检查节点进程</h4><p>使用<code>ps -ef | grep node</code>命令来检查节点的进程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133556.png" alt=""></p>
<h4 id="19-检查端口进程"><a href="#19-检查端口进程" class="headerlink" title="(19)检查端口进程"></a>(19)检查端口进程</h4><p>使用<code>netstat -anlp | grep 20200</code> 来检查端口进程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133625.png" alt=""></p>
<h4 id="20-查看运行日志"><a href="#20-查看运行日志" class="headerlink" title="(20)查看运行日志"></a>(20)查看运行日志</h4><p>使用<code>grep -B 3 &quot;main run success&quot; log/WeBASE-Front.log</code>来查看运行日志<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133706.png" alt=""></p>
<h4 id="21-图形化控制台"><a href="#21-图形化控制台" class="headerlink" title="(21)图形化控制台"></a>(21)图形化控制台</h4><p>最后我们可以通过访问<code>http://localhost:5002/WeBASE-Front</code><br>访问这个网站之后，我们可以看到一个图形化控制台<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133751.png" alt=""><br> 我们可以看到这里的四个节点都正常在运行，并且随机赋予了每个节点不同的节点ID。<br> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133812.png" alt=""><br> 在合约IDE界面，我们可以编写合约的算法逻辑，来实现公司交易的算法逻辑，我们将以及编写好的Loan.sol<br> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133842.png" alt=""><br> 在上传成功之后，我们可以进行编译合约，然后进行合约的调用。<br> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133904.png" alt=""><br> 这里我们可以看到，在这里，合约调用成功，并且成功返回了一个交易回执。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133918.png" alt=""></p>
<h4 id="22-监控查看"><a href="#22-监控查看" class="headerlink" title="(22)监控查看"></a>(22)监控查看</h4><p>此外我们可以进行数据的监控查看<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133943.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908133954.png" alt=""></p>
<h4 id="23-实现数据的交互"><a href="#23-实现数据的交互" class="headerlink" title="(23)实现数据的交互"></a>(23)实现数据的交互</h4><p>然后在python-sdk中，我们需要编写，调用该虚拟环境的函数，借此实现数据的交互。在此处，我们需要将Loan.sol注入到<code>python-sdk/contracts</code>文件夹中，以及将编写的函数注入到python-sdk函数当中，并且将生成的随机地址，写入到编写的函数当中。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134030.png" alt=""></p>
<p>在运行之后，我们可以的到合约的URL，将该URL注入到iOSAPP中，就可以在iOS中实现公司交易查询等一系列操作</p>
<p>获取名称为A的公司的信息</p>
<p><code>GET: &#123;http://172.16.207.150 &#125;:8383/get_company_inf/?cpName=A</code></p>
<p>获取所有公司A参与交易的单据</p>
<p><code>GET: &#123;http://172.16.207.150&#125;:8383/get_receipt/?cpName=A</code></p>
<p>获取银行bank_1向公司A提供的信用资产的数额</p>
<p><code>GET: &#123;http://172.16.207.150&#125;:8383/get_AmountOfCreditAsset_bank_GiveTo_TrustedCompany/?bName=bank_1&amp;cpName=A</code><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134107.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134123.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134133.png" alt=""></p>
<h4 id="24-新建用户，部署合约"><a href="#24-新建用户，部署合约" class="headerlink" title="(24)新建用户，部署合约"></a>(24)新建用户，部署合约</h4><p>值得注意的是：Solidity不支持返回变长变量，所以查询结构体时，无法看到其中的变长数组和mapping映射。<br>在WeBASE-Front控制台中选择私钥管理选项，点击新增用户按钮，输入新用户名创建新用户。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134154.png" alt=""></p>
<p>点击部署按钮，使用Administrator用户的私钥，输入仲裁机构的名称来初始化合约。部署成功会有弹窗反馈。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134210.png" alt=""></p>
<h4 id="25-添加公司"><a href="#25-添加公司" class="headerlink" title="(25)添加公司"></a>(25)添加公司</h4><p>点击合约调用按钮，选择addCompany方法，用Administrator的私钥创建受信公司A。并用相同的方法创建普通公司B和C。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134228.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134240.png" alt=""></p>
<h4 id="26-添加银行"><a href="#26-添加银行" class="headerlink" title="(26)添加银行"></a>(26)添加银行</h4><p>使用addBank方法创建银行bank_1<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134301.png" alt=""></p>
<h4 id="27-行向受信公司授权信用资产"><a href="#27-行向受信公司授权信用资产" class="headerlink" title="(27)行向受信公司授权信用资产"></a>(27)行向受信公司授权信用资产</h4><p>调用<code>bank_giveCreditAssetTo_trustedCompany</code>方法，令银行</p>
<p>bank_1授权信用资产给公司A，数值为1000；完成后查看receipts[0]，确认交易单据上链；并查看companies[0]公司A的情况，确认其信用资产已正确增加。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134331.png" alt=""></p>
<p>receipts[0]：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134346.png" alt=""></p>
<p>companies[0]：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134402.png" alt=""></p>
<h4 id="28-公司A向公司B转移信用资产："><a href="#28-公司A向公司B转移信用资产：" class="headerlink" title="(28)公司A向公司B转移信用资产："></a>(28)公司A向公司B转移信用资产：</h4><p>调用<code>companyA_giveCreditAssetTo_companyB</code>方法，令公司A转移信用资产给公司B，数值为500；完成后查看receipts[1]，确认交易单据上链；并查看companies[0]公司A和companies[1]公司B的情况，确认信用资产已正确转移。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134426.png" alt=""></p>
<p>receipts[1]:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134440.png" alt=""></p>
<p>companies[0]:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134502.png" alt=""></p>
<p>companies[1]:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134518.png" alt=""></p>
<h4 id="29-银行给予公司真实资金"><a href="#29-银行给予公司真实资金" class="headerlink" title="(29)银行给予公司真实资金"></a>(29)银行给予公司真实资金</h4><p>调用<code>bank_giveRealMoneyTo_company</code>方法，令银行给予公司B 真实资金，数值为500；完成后查看receipts[2]，确认交易单据上链；并查看companies[1]公司B的情况，确认真实资金正确转移。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134541.png" alt=""></p>
<p>receipts[2]:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134557.png" alt=""></p>
<p>companies[1]:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134611.png" alt=""></p>
<h4 id="30-受信公司向银行还款"><a href="#30-受信公司向银行还款" class="headerlink" title="(30)受信公司向银行还款"></a>(30)受信公司向银行还款</h4><p>调用<code>trustedCompany_repaidTo_bank</code>方法，令受信公司A归还款项给银行，数值为500；完成后查看receipts[3]，确认交易单据上链。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134653.png" alt=""></p>
<p>receipts[3]:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134710.png" alt=""></p>
<h4 id="31-受信公司向银行确认完成本次事务"><a href="#31-受信公司向银行确认完成本次事务" class="headerlink" title="(31)受信公司向银行确认完成本次事务"></a>(31)受信公司向银行确认完成本次事务</h4><p>调用<code>trustedCompany_FinishWith_Bank</code>方法，令受信公司A向银行bank_1确认完成本次事务；完成后查看companies[0]公司A，确认已正确归零，以及trustedCompanyHasFinishedWithBank值，确认已置为true。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134730.png" alt=""></p>
<p>companies[0]:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134746.png" alt=""></p>
<p>rustedCompanyHasFinishedWithBank:<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134802.png" alt=""></p>
<h3 id="方法创新"><a href="#方法创新" class="headerlink" title="方法创新"></a>方法创新</h3><h4 id="1-存储设计"><a href="#1-存储设计" class="headerlink" title="(1)存储设计"></a>(1)存储设计</h4><p>使用storage数据位置储存需要上链的变量，这样数据将永远存在于区块链上。</p>
<p>项目背景中所述的供应链金融平台，需要仲裁机构、金融机构(银行）和公司这几方角色，以及记录交易的单据。在智能合约中，使用结构体实现这些角色、储存每个角色的信息。下面结合代码对角色功能及需要储存的角色信息进行说明。</p>
<h5 id="仲裁机构："><a href="#仲裁机构：" class="headerlink" title="仲裁机构："></a>仲裁机构：</h5><p>只有仲裁机构有权限添加银行实例和公司实例。</p>
<p>仲裁机构结构体包含：</p>
<p>字符串ArbitralName,机构名称；</p>
<p>address变量ArbitrallnstitutionAddres,仲裁机构的账户地址。</p>
<p>储存地址是为了在之后的操作中进行地址对比，判断操作者是否是仲裁机构。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908134952.png" alt=""></p>
<h5 id="银行："><a href="#银行：" class="headerlink" title="银行："></a>银行：</h5><p>银行可以向受信公司发放信用资产，接收受信公司的还款。并且公司能够消耗信用资产，从银行获得等额的真实资金。</p>
<p>银行结构体包含：</p>
<p>字符串bankName,银行名称；</p>
<p>无符号整型数组ReceiptIndex_loanMoneyToCompany,储存向公司提供资金的交易单据的索引值。使用该索引值可以在合约的receipts数组中访问对应单据；</p>
<p>无符号整型数组ReceiptIndex_authorizeCreditAssetToCompany,储存银行向受信公司授权信用资产的交易单据的索引值。使用该索引值可以在合约的receipts数组中访问对应单据；</p>
<p>无符号整型数组</p>
<p>ReceiptIndex_getRepaidMoneyFromTrustedCompany,储存受信公司向银行归还资金的交易单据的索引值。使用该索引值可以在合约的receipts数组中访问对应单据；</p>
<p>字符串到无符号整型的映射companyDebtAmount,储存受信公司应向银行归还的资金数额。映射形式：公司名称-&gt;资金数额<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135010.png" alt=""></p>
<h5 id="公司："><a href="#公司：" class="headerlink" title="公司："></a>公司：</h5><p>公司可以分为受信公司（布尔值isTrusted为true)和普通公司(isTrusted为false)。银行只会向受信公司授权信用资产，并且由受信公司负责向银行归还资金。信用资产可以在任何公司间流通，每个公司都可以用信用资产向银行换取真实资金。在本合约中，一次需要信用传递的交易生产过程里有且只有一个受信公司。</p>
<p>公司结构体包含：</p>
<p>字符串companyName,公司名称；</p>
<p>字符串companyType,公司类型；</p>
<p>布尔值isTrusted,是否为受信公司，true表示是受信公司；</p>
<p>无符号整型creditAsset,当前信用资产数额；</p>
<p>无符号整型数组</p>
<p>ReceiptIndex_getCreditAssetFromCompanyOrBank,储存其他公司或银行给予自身信用资产的交易单据的索引值。使用该索引值可以在合约的receipts数组中访问对应单据；</p>
<p>无符号整型数组ReceiptIndex_giveCreditAssetToCompany,储存自身给予其他公司信用资产的交易单据的索引值。使用该索引值可以在合约的receipts数组中访问对应单据；</p>
<p>无符号整型realMoney,当前真实资金数额；</p>
<p>无符号整型数组ReceiptIndex_getRealMoneyFromBank,储存银行给予自身真实资金的交易单据的索引值。使用该索引值可以在合约的receipts数组中访问对应单据；</p>
<p>无符号整型数组ReceiptIndex_repayRealMoneyToBank,储存自身归还银行真实资金的交易单据的索引值。使用该索引值可以在合约的receipts数组中访问对应单据；<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135205.png" alt=""></p>
<h5 id="单据："><a href="#单据：" class="headerlink" title="单据："></a>单据：</h5><p>单据可以记录所有交易和资产转移。单据的记录形式永远是实体,A向实体B提供某种资产。</p>
<p>单据结构体包含：</p>
<p>字符串Name_A,交易中实体A名称；</p>
<p>字符串Name_B,交易中实体B名称；</p>
<p>布尔值bankParticipation,此次交易是否有银行参与；</p>
<p>布尔值isRealMoney,此次交易是否是真实资金的转移；</p>
<p>无符号整型amount,交易资产的数额；<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135332.png" alt=""></p>
<h5 id="合约中其他数据结构："><a href="#合约中其他数据结构：" class="headerlink" title="合约中其他数据结构："></a>合约中其他数据结构：</h5><p>仲裁机构结构体arbitrallnstitution,储存仲裁机构实例；</p>
<p>公司结构体数组companies,储存所有公司实例；</p>
<p>银行结构体数组banks,储存所有银行实例；</p>
<p>单据结构体数组receipts,储存所有单据实例；</p>
<p>布尔值trustedCompanyHasFinishedWithBank,表示受信公司是否已经向银行还清资金并确认本次事务完成，若为true表示完成。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135356.png" alt=""></p>
<h4 id="2-数据流图"><a href="#2-数据流图" class="headerlink" title="(2)数据流图"></a>(2)数据流图</h4><p>合约涉及的主要机制：信用资产流通机制、真实资金流通机制。</p>
<p>这里先给出这两套机制所确定的整个系统的性质：</p>
<p>只有受信公司能获得银行的信用资产授权；公司的信用资产只能向银行兑换真实资金；最终由受信公司向银行还款；所有公司从银行</p>
<p>获得的真实资金数额不会超过银行授权给受信公司的信用资产数额。即永远不会出现信用超支的情况。</p>
<h5 id="信用资产creditAsset的流通机制："><a href="#信用资产creditAsset的流通机制：" class="headerlink" title="信用资产creditAsset的流通机制："></a>信用资产creditAsset的流通机制：</h5><p>-初始时，只有受信公司A能得到银行授权，拥有信用资产</p>
<p>-信用资产可以在公司之间流通</p>
<p>-信用资产的产生和转移情况都会上链<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135425.png" alt=""></p>
<h5 id="真实资金realMoney的流通机制："><a href="#真实资金realMoney的流通机制：" class="headerlink" title="真实资金realMoney的流通机制："></a>真实资金realMoney的流通机制：</h5><p>-公司向银行获取真实资金要消耗自身等额的信用资产</p>
<p>-由受信公司向银行还款</p>
<p>-真实资金的转移情况上链<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135503.png" alt=""></p>
<h4 id="3-核心创新功能"><a href="#3-核心创新功能" class="headerlink" title="(3)核心创新功能"></a>(3)核心创新功能</h4><h5 id="合约初始化："><a href="#合约初始化：" class="headerlink" title="合约初始化："></a>合约初始化：</h5><p>根据传入的仲裁机构名称，才合约中创建一个仲裁机构实例，并将其中储存的用户地址设为创建本合约的用户地址。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135602.png" alt=""></p>
<h5 id="添加公司："><a href="#添加公司：" class="headerlink" title="添加公司："></a>添加公司：</h5><p>若当前msg.sender为仲裁机构地址，且传入的公司类型cpType不为“bank”，且传入的公司名称cpName没有与已有的任何公司和银行的名称重复，那么根据传入的公司名称cpName、公司类型cpType和是否为受信公司whetherTrusted来创建一个新的公司实例，初始信用资产和真实资金均为0,收据索引数组均为空。并将这个新创建的公司实例添加到合约的companies数组中。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135629.png" alt=""></p>
<h5 id="添加银行："><a href="#添加银行：" class="headerlink" title="添加银行："></a>添加银行：</h5><p>若当前msg.sender为仲裁机构地址，且传入的银行名称bName没有与已有的任何公司和银行的名称重复，那么根据传入的bName创建一个新的银行实例，收据索引数组均为空。并将这个新创建的银行实例添加到合约的banks数组中。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135654.png" alt=""></p>
<h5 id="创建新单据（内部方法）"><a href="#创建新单据（内部方法）" class="headerlink" title="创建新单据（内部方法）:"></a>创建新单据（内部方法）:</h5><p>根据传入的实体A名称nameA、实体B名称B、转移资产的数量amt、是否有银行参与bankParticipates和是否是真实资金的转移realMoney,创建一个记录资产从实体A转移到实体B的单据，并将此新创建的单据添加到合约的receipts数组中。该方法会在后续的一些方法中被调用。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135713.png" alt=""></p>
<h5 id="银行向受信公司授权信用资产："><a href="#银行向受信公司授权信用资产：" class="headerlink" title="银行向受信公司授权信用资产："></a>银行向受信公司授权信用资产：</h5><p>若传入的授权信用资产数量amt为正，且传入的银行名称bName和公司名称cpName合法，且cpName对应的公司是受信公司，那么根据传入的银行名称bName、公司名称cpName和授权信用资产数量amt,调用newReceipt方法创建银行向公司授权信用资产的新单据。<br>新单据在receipts数组中的索引存入银行与该公司相应的单据索引储存数组中。银行中储存的该受信公司应向银行归还的资金数额增加amt。该受信公司的信用资产增加amt。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135735.png" alt=""></p>
<h5 id="公司A向公司B转移信用资产："><a href="#公司A向公司B转移信用资产：" class="headerlink" title="公司A向公司B转移信用资产："></a>公司A向公司B转移信用资产：</h5><p>若传入的信用资产转移数量amt为正，且传入的公司A名称companyName_A和公司B名称companyName_B合法，且公司A当前拥有的信用资产数值大于amt,那么根据传入的信用资产转移数量amt、公司A名称companyName_A和公司B名称companyName_B,调用newReceipt方法创建公司A向公司B转移信用资产的新单据。</p>
<p>新单据在receipts数组中的索引存入双方相应的单据索引储存数组中。公司A的信用资产减少amt;公司B的信用资产增加amt。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135757.png" alt=""></p>
<h5 id="银行给予公司真实资金："><a href="#银行给予公司真实资金：" class="headerlink" title="银行给予公司真实资金："></a>银行给予公司真实资金：</h5><p>若传入的资金转移数量amt为正，且传入的银行名称bName和公司名称cpName合法，那么根据传入的银行名称bName、公司名称cpName和转移资金数量amt,调用newReceipt方法创建银行向公司转移资金的新单据。</p>
<p>新单据在receipts数组中的索引存入银行与该公司相应的单据索引储存数组中。该公司的信用资产减少amt,真实资金增加amt。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135829.png" alt=""></p>
<h5 id="受信公司向银行还款："><a href="#受信公司向银行还款：" class="headerlink" title="受信公司向银行还款："></a>受信公司向银行还款：</h5><p>若传入的还款数额amt为正，且传入的公司名称cpName和银行名称bName合法，且cpName对应的公司是受信公司，且还款数额amt合法，即amt小于等于银行记录的授权给该受信公司的信用资产数值减去该公司当前剩余的信用资产数值，那么根据传入的受信公司名称cpName、银行名称bName和还款数额amt,调用newReceipt方法创建受信公司向银行归还资金的新单据。</p>
<p>新单据在receipts数组中的索引存入银行与该公司相应的单据索引储存数组中。银行记录的授权给该受信公司的信用资产数值减少Amt。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908135854.png" alt=""></p>
<h5 id="受信公司向银行确认完成本次事务："><a href="#受信公司向银行确认完成本次事务：" class="headerlink" title="受信公司向银行确认完成本次事务："></a>受信公司向银行确认完成本次事务：</h5><p>若传入的传入的公司名称cpName和银行名称bName合法，且cpName对应的公司是受信公司，且受信公司当前信用资产数值等于银行记录的授权给该受信公司的信用资产数值，即受信公司没有未还款项，那么可以确认完成本次事务。受信公司信用资产数值归零；银行记录的授权给该受信公司的信用资产数值归零；合约中变量trustedCompanyHasFinishedWithBank变为true。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140207.png" alt=""></p>
<h5 id="一些查询链上信息的方法："><a href="#一些查询链上信息的方法：" class="headerlink" title="一些查询链上信息的方法："></a>一些查询链上信息的方法：</h5><p>根据公司名称查询公司信息<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140235.png" alt=""><br>根据银行名称查询银行信息<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140506.png" alt=""><br>根据银行名称和受信公司名称查询受信公司应向银行归还的资金数额<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140553.png" alt=""><br>获得现有公司、银行、单据实例的个数<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140609.png" alt=""></p>
<h2 id="3-项目成果的学术价值"><a href="#3-项目成果的学术价值" class="headerlink" title="3.项目成果的学术价值"></a>3.项目成果的学术价值</h2><h3 id="1-共识算法"><a href="#1-共识算法" class="headerlink" title="(1)共识算法"></a>(1)共识算法</h3><p>区块链系统通过共识算法保障系统一致性。 理论上，共识是对某个提案(proposal)达成一致意见的过程，分布式系统中提案的含义十分宽泛，包括事件发生顺序、谁是leader等。区块链系统中，共识是各个共识节点对交易执行结果达成一致的过程。</p>
<p>共识算法分类<br>根据是否容忍 拜占庭错误 ，共识算法可分为容错(Crash Fault Tolerance, CFT)类算法和拜占庭容错(Byzantine Fault Tolerance, BFT)类算法：</p>
<p>CFT类算法 ：普通容错类算法，当系统出现网络、磁盘故障，服务器宕机等普通故障时，仍能针对某个提议达成共识，经典的算法包括Paxos、Raft等，这类算法性能较好、处理速度较快、可以容忍不超过一半的故障节点；</p>
<p>BFT类算法 ：拜占庭容错类算法，除了容忍系统共识过程中出现的普通故障外，还可容忍部分节点故意欺骗(如伪造交易执行结果)等拜占庭错误，经典算法包括PBFT等，这类算法性能较差，能容忍不超过三分之一的故障节点。</p>
<p>FISCO BCOS共识算法</p>
<p>FISCO BCOS基于多群组架构实现了插件化的共识算法，不同群组可运行不同的共识算法，组与组之间的共识过程互不影响，FISCO BCOS目前支持PBFT(Practical Byzantine Fault Tolerance)和Raft(Replication and Fault Tolerant)两种共识算法：</p>
<p>PBFT共识算法: BFT类算法，可容忍不超过三分之一的故障节点和作恶节点，可达到最终一致性；</p>
<p>Raft共识算法: CFT类算法, 可容忍一半故障节点，不能防止节点作恶，可达到一致性。</p>
<h3 id="2-智能合约"><a href="#2-智能合约" class="headerlink" title="(2)智能合约"></a>(2)智能合约</h3><p>交易的执行是区块链节点上的一个重要的功能。交易的执行，是把交易中的智能合约二进制代码取出来，用执行器（Executor）执行。共识模块（Consensus）把交易从交易池(TxPool)中取出，打包成区块，并调用执行器去执行区块中的交易。在交易的执行过程中，会对区块链的状态（State）进行修改，形成新区块的状态储存下来（Storage）。执行器在这个过程中，类似于一个黑盒，输入是智能合约代码，输出是状态的改变。</p>
<p>随着技术的发展，人们开始关注执行器的性能和易用性。一方面，人们希望智能合约在区块链上能有更快的执行速度，满足大规模交易的需求。另一方面，人们希望能用更熟悉更好用的语言进行开发。进而出现了一些替代传统的执行器（EVM）的方案，如：JIT、 WASM_甚至JVM。然而，传统的EVM是耦合在节点代码中的。首先要做的，是将执行器的接口抽象出来，兼容各种虚拟机的实现。因此，EVMC被设计出来。</p>
<p>EVMC (Ethereum Client-VM Connector API)，是以太坊抽象出来的执行器的接口，旨在能够对接各种类型的执行器。FISCO BCOS目前采用了以太坊的智能合约语言Solidity，因此也沿用了以太坊对执行器接口的抽象。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140743.png" alt=""></p>
<p>在节点上，共识模块会调用EVMC，将打包好的交易交由执行器执行。执行器执行时，对状态进行的读写，会通过EVMC的回调反过来操作节点上的状态数据。</p>
<p>经过EVMC一层的抽象，FISCO BCOS能够对接今后出现的更高效、易用性更强的执行器。目前，FISCO BCOS采用的是传统的EVM根据EVMC抽象出来的执行器—Interpreter。因此能够支持基于Solidity语言的智能合约。目前其他类型的执行器发展尚未成熟，后续将持续跟进。</p>
<h3 id="3-对等网络"><a href="#3-对等网络" class="headerlink" title="(3)对等网络"></a>(3)对等网络</h3><p>设计目标<br>FISCO BCOS P2P模块提供高效、通用和安全的网络通信基础功能，支持区块链消息的单播、组播和广播，支持区块链节点状态同步，支持多种协议。</p>
<p>P2P主要功能<br>区块链节点标识<br>通过区块链节点标识唯一标识一个区块链节点，在区块链网络上通过区块链节点标识对区块链节点进行寻址</p>
<p>管理网络连接<br>维持区块链网络上区块链节点间的TCP长连接，自动断开异常连接，自动发起重连</p>
<p>消息收发<br>在区块链网络的区块链节点间，进行消息的单播、组播或广播</p>
<p>状态同步<br>在区块链节点间同步状态</p>
<p>区块链节点标识<br>区块链节点标识由ECC算法的公钥生成，每个区块链节点必须有唯一的ECC密钥对，区块链节点标识在区块链网络中唯一标识一个区块链节点</p>
<p>通常情况下，一个节点要加入区块链网络，至少要准备三个文件：</p>
<p>node.key 节点密钥，ECC格式</p>
<p>node.crt 节点证书，由CA颁发</p>
<p>ca.crt CA证书，CA机构提供</p>
<p>区块链节点除了有唯一区块链节点标识，还能关注Topic，供寻址使用</p>
<p>区块链节点寻址：</p>
<p>区块链节点标识寻址<br>通过区块链节点标识，在区块链网络中定位唯一的区块链节点</p>
<p>Topic寻址<br>通过Topic，在区块链网络中定位一组关注该Topic的节点</p>
<p>管理网络连接<br>区块链节点间，会自动发起和维持TCP长连接，在系统故障、网络异常时，主动发起重连<br>区块链节点间建立连接时，会使用CA证书进行认证</p>
<p>连接建立流程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140829.png" alt=""></p>
<p>消息收发<br>区块链节点间消息支持单播、组播和广播</p>
<p>单播，单个区块链节点向单个区块链节点发送消息，通过区块链节点标识寻址<br>组播，单个区块链节点向一组区块链节点发送消息，通过Topic寻址<br>广播，单个区块链节点向所有区块链节点发送消息</p>
<p>单播流程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140852.png" alt=""></p>
<p>组播流程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140906.png" alt=""></p>
<p>广播流程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140921.png" alt=""></p>
<p>状态同步</p>
<p>每个节点会维护自身的状态，并将状态的Seq在全网定时广播，与其它节点同步<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908140940.png" alt=""></p>
<p>AMOP 消息转发流程<br>单播时序图<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141038.png" alt=""><br>多播时序图<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141055.png" alt=""><br>带身份验证的单播时序图<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141115.png" alt=""><br>通信协议使用的数据结构:</p>
<p>0x37 消息类型中 content 数据结构：</p>
<p><code>&#123;&quot;nodeId&quot;:&quot;2bb4562f4f4b69e2c5156510da4beddfca548403eb7cea49bd56daed46de31e4d78a44fdfa051170c64f0233dbc0fd75b5b4e8bc2df50a3c9ade833794128623&quot;,&quot;topic&quot;:&quot;#!$TopicNeedVerify_hello&quot;,&quot;topicForCert&quot;:&quot;#!$VerifyChannel_#!$TopicNeedVerify_hello_92be6ce4dbd311eaae5a983b8fda4e0e&quot;&#125;</code></p>
<p>随机数单播中的 content 数据结构：<br><code>&#123;&quot;randValue&quot;:&quot;14131f50ef730219d48e1f9c441db871c&quot;,&quot;topic&quot;:&quot;hello&quot;&#125;</code></p>
<p>随机数签名回包中 content 数据结构：<br><code>&#123;&quot;signature&quot;:&quot;vU/Vzqn4MiP0nO1xN+M5TOk/YcyFtY/TLrgU38jFdooN66r3TzNVKEBpkNId8gCuAeNpNPCo8vmTV3dcs/Xj1AE=&quot;&#125;</code></p>
<p>0x38 消息类型中 content 数据结构：<br><code>&#123;&quot;checkResult&quot;:0,&quot;nodeId&quot;:&quot;2bb4562f4f4b69e2c5156510da4beddfca548403eb7cea49bd56daed46de31e4d78a44fdfa051170c64f0233dbc0fd75b5b4e8bc2df50a3c9ade833794128623&quot;,&quot;topic&quot;:&quot;#!$TopicNeedVerify_hello&quot;&#125;</code></p>
<h3 id="4-交易并行"><a href="#4-交易并行" class="headerlink" title="(4)交易并行"></a>(4)交易并行</h3><p>DAG</p>
<p>一个无环的有向图称做有向无环图（Directed Acyclic Graph），简称DAG图。在一批交易中，可以通过一定方法识别出每笔交易需要占用的互斥资源，再根据交易在Block中的顺序及互斥资源的占用关系构造出一个交易依赖DAG图，如下图所示，凡是入度为0（无被依赖的前序任务）的交易均可以并行执行。如下图所示，基于左图的原始交易列表的顺序进行拓扑排序后，可以得到右图的交易DAG。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141343.png" alt=""></p>
<p>模块架构<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141406.png" alt=""></p>
<p>其中主要流程包括：</p>
<p>用户直接或间接通过SDK发起交易。交易可以是能够并行执行的交易和不能并行执行的交易；</p>
<p>交易进入节点的交易池中，等待打包；</p>
<p>交易被Sealer打包为区块，经过共识后，发送至BlockVerifier进行验证；</p>
<p>BlockVerifier根据区块中的交易列表生成交易DAG；</p>
<p>BlockVerifier构造执行上下文，并行执行交易DAG；</p>
<p>区块验证通过后，区块上链。</p>
<p>DAG数据结构<br>方案中所用到的DAG数据结构如下：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141434.png" alt=""><br>其中：<br>顶点（Vertex）<br>inDegree用于存储顶点当前的入度;<br>outEdge用于保存该顶点的出边信息，具体为所有出边所连顶点的ID列表。<br>DAG：<br>vtxs是用于存储DAG中所有节点的列表；<br>topLevel是一个并发队列，用于存储当前入度为0的节点ID，执行时供多个线程并发访问；<br>totalVtxs：顶点总数<br>totalConsume：已经执行过的顶点总数；<br>void init(uint32_t _maxSize)：初始化一个最大顶点数为maxSize的DAG；<br>void addEdge(ID from, ID to)：在顶点from和to之间建立一条有向边；<br>void generate()：根据已有的边和顶点构造出一个DAG结构；<br>ID waitPop(bool needWait)：等待从topLevel中取出一个入度为0的节点；<br>void clear()：清除DAG中所有的节点与边信息。<br>TxDAG:<br>dag：DAG实例<br>exeCnt：已经执行过的交易计数；<br>totalParaTxs：并行交易总数；<br>txs：并行交易列表<br>bool hasFinished()：若整个DAG已经执行完毕，返回true，否则返回false;<br>void executeUnit()：取出一个没有上层依赖的交易并执行；</p>
<p>交易DAG构造流程<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141523.png" alt=""><br>1.从打包好的区块从取出区块中的所有交易；<br>2.将交易数量作为最大顶点数量初始化一个DAG实例；<br>3.按序读出所有交易，如果一笔交易是可并行交易，则解析其冲突域，并检查是否有之前的交易与该交易冲突，如果有，则在相应交易间构造依赖边；若该交易不可并行，则认为其必须在前序的所有交易都执行完后才能执行，因此在该交易与其所有前序交易间建立一条依赖边。</p>
<p>DAG执行流程<br>流程如下：<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141545.png" alt=""><br>主线程会首先根据硬件核数初始化一个相应大小的线程组，若获取硬件核数失败，则不创建其他线程；<br>当DAG尚未执行完毕时，线程循环等待从DAG中pop出入度为0的交易。若成功取出待执行的交易，则执行该交易，执行完后将后续的依赖任务的入度减1，若有交易入度被减至0，则将该交易加入topLevel中；若失败，则表示DAG已经执行完毕，线程退出。</p>
<h2 id="4-项目成果的社会效益和经济效益，尚需深入研究的问题等"><a href="#4-项目成果的社会效益和经济效益，尚需深入研究的问题等" class="headerlink" title="4.项目成果的社会效益和经济效益，尚需深入研究的问题等"></a>4.项目成果的社会效益和经济效益，尚需深入研究的问题等</h2><h3 id="社会效益"><a href="#社会效益" class="headerlink" title="社会效益"></a>社会效益</h3><h4 id="1-打造全场景透明管理，建信筑和联手FISCO-BCOS助力建造业数字化"><a href="#1-打造全场景透明管理，建信筑和联手FISCO-BCOS助力建造业数字化" class="headerlink" title="(1)打造全场景透明管理，建信筑和联手FISCO BCOS助力建造业数字化"></a>(1)打造全场景透明管理，建信筑和联手FISCO BCOS助力建造业数字化</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141634.png" alt=""><br>随着工业4.0时代持续推进，区块链逐渐挥别纯粹的技术自赏和金融标签，渗透进各类实体产业。</p>
<p>在传统建造场景下，行业信息不透明、管理协同性差、信息化水平不高等“痼疾”，使得建造项目的推进过程存在管理难、追责难、监管难、信任难的问题。“区块链+建造”的结合，利用区块链技术，瞄准这些行业痛点，提出了应用层面的切实解决方案。</p>
<p>深圳市建信筑和科技有限公司（以下简称：建信筑和）基于FISCO BCOS区块链平台开发的“伊OS透明建造解决方案”，正是区块链技术在建造行业场景化应用的典型代表。</p>
<p>该方案凭借全场景管理模式的领先优势，入选区块链服务网络BSN首批官方指定应用，并在工信部中国电子技术标准化研究院主办的2020年第四届中国区块链开发大赛上，斩获桂冠。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141649.png" alt=""></p>
<p>信息不对称+管理难协同，建造业痛点待破局<br>在传统建造业中，“信息不对称+管理难协同”是制约行业发展的重要因素。建造业上下游链条很长，如果产业链上每个环节的参与者之间信息不透明，无形中提高了工作协同的沟通、管理成本。诸如施工方和设计方对于设计方案的扯皮、各主体间款项账期的节点把控模糊等问题层出不穷，拖慢整体工程进度。同时，信息不透明也使甲方难以实现全流程式管理穿透，管理不及时、不到位为项目埋下了违规风险，进一步推高信任成本，反过来又加重了工作协同难度。</p>
<p>在传统行业中，建造业信息化程度一直处于较低水平，建设过程中涉及业主投资方、监管方、代建方、咨询方、设计方、施工方、监理方、运营方等众多单位，同时随着当前各类工程项目投资规模的不断扩大，项目管理和资金监管方面压力大，这些问题制约着建造业生态的健康成长。因此，传统建造业的破局路径之一，就是尽快打破现状，利用信息化手段推动建造业实现项目管理“全场景、全主体、全流程透明协同”，而区块链，则是加速技术化进程的独特手段。</p>
<p>在此背景下，建信筑和加入FISCO BCOS区块链开源生态，基于FISCO BCOS区块链技术打造了面向建造行业的全生命周期管理系统——“伊OS透明建造解决方案”，以推进建造行业实现“全场景透明化管理”。该解决方案运用区块链分布式存储/共享、智能合约等技术，与建造行业已有成熟的IT工具如设计软件、造价系统、智慧工地、BIM系统等进行整合，同时结合大数据和人工智能等先进技术，有效破除了行业痛点，构建了一个具有管理穿透、公开透明、信息共享、信用评价的全过程透明建设平台。</p>
<p>区块链技术助力，建造实现全场景穿透管理<br>“伊OS透明建造解决方案”采取了场景式存证、数字签名、加密算法、智能合约等区块链技术，打破了原有单线任务框架，实现了去中心化的任务协同和数据流转。将原有项目链条（产业链条）上的参与者，例如项目方、设计、施工、勘察、总包、分包、监理、班组等，置于同一任务场景中，不再具有严格的上下游流程关系，原来极易形成彼此掣肘的“物流、资金流、信息流”也能做到有机协同。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141723.png" alt=""></p>
<p>同时由于智能合约触发机制的存在，工程资金流向有了明确的监管方向，资金流转的每一步都可透明，这将进一步确保资金使用的合理、合规、合法。同时，工程资金透明也使得工程质量和安全更有保障，形成建造产业良性循环。</p>
<p>“伊OS透明建造解决方案”不仅能够实现单项目多标段管理，还可以实现多项目管理，目前已被广泛运用在建造行业，有效提升项目运行效率。截止2020年5月底，伊OS平台上运行项目超300个，参建单位达400多家。在某集团在建的100+个管网项目中，伊OS系统协助项目负责人全面的管理现场施工的过程、进度、质量、安全进行，通过奖惩机制成功落地执行，让项目问题解决率从60%提升到80%。</p>
<p>建信筑和CTO房少君表示，区块链技术遇见建造行业，不仅可以对项目全过程实施文件共享、资金监管、工程量申报、质量安全、绩效考核等全场景“俯瞰”，而且能有效点亮原先项目管理、工程结算及资金监管上的“盲区”，“事前任务分布-事中实时监督-事后责任追溯”自此形成了高效协同的有机闭环。</p>
<p>万字报告选定FISCO BCOS，携手重塑建造信用生态<br>为了有效地打造“伊OS透明建造解决方案”，建信筑和选择了FISCO BCOS。“为了甄选区块链底层平台，我们团队专门做了一份过万字的研究报告，最终选定FISCO BCOS，主要是因为它拥有不可多得的语言优势，生态组件、节点部署和技术支持等都非常丰富、易用和高效。”房少君介绍，在FISCO BCOS技术底层上，建信筑和有效地完成了五大业务场景的系统化构建：场景式存证、工程量申报、资金监管、数据交易确权和票据流转。<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210908141809.png" alt=""><br>基于FISCO BCOS区块链技术的“伊OS透明建造解决方案”能够确保项目实施过程中物流流转和信息流转一一对应、资金流向透明监管、物流全程可追溯和资金到账的高度匹配，不仅是区块链在建造行业中的项目管理流程再造，更是新型“全场景”式管理模式下的信用生态重塑。</p>
<h3 id="2-“人民版权”存证原创新闻超200万篇-FISCO-BCOS应用案例"><a href="#2-“人民版权”存证原创新闻超200万篇-FISCO-BCOS应用案例" class="headerlink" title="(2)“人民版权”存证原创新闻超200万篇 | FISCO BCOS应用案例"></a>(2)“人民版权”存证原创新闻超200万篇 | FISCO BCOS应用案例</h3><p>2019年7月，基于FISCO BCOS区块链底层技术研发的一站式版权管理平台“人民版权”正式上线。至2020年第一季度，该平台在版权原创存证、侵权监测、司法维权方面取得一系列成果：<br>“人民版权”已为超过200万篇新闻稿件进行版权存证；可自动识别的新闻数超过1亿条，相当于3年的新闻总量；全网监测数据量日均近300万条, 全年总监测量超过10亿条。</p>
<p>目前，“人民版权”已经通过国家网信办境内区块链信息服务备案。未来，平台将持续通过区块链、人工智能等创新技术与知识产权保护深度融合，对抗侵权问题，助力构建版权保护新生态。</p>
<p>区块链助力版权保护 存证新闻报道200万篇</p>
<p>近年来，近六成原创媒体作者遭遇过内容侵权，原创稿件被侵权频次高达每篇作品3.64次。网络的虚拟性使得侵权行为难以被及时发现和识别；网络的即时性和裂变传播，令侵权的发展更为迅速，为版权溯源、取证维权也带来了困难。</p>
<p>“人民版权”利用区块链技术的完整性、可追溯性、不可篡改性等特点，综合应用基于区块链的分布式身份解决方案WeIdentity，实现了数字作品链上信息追溯和全网数据监测在内的版权保护全流程管理。</p>
<p>自上线以来，“人民版权”已为2,030,890篇原创新闻报道进行了版权存证保护。全网实时对比监测稿件量达日均2,871,903篇，全年总监测量超过10亿条。识别采集媒体总量达9,988,781家，覆盖了将近全部的电子报刊、网络媒体以及主流客户端。海量信息的实时监测，为快速识别侵权转载并取证上链提供了前提。</p>
<p>首创梯度化司法服务 低成本完成侵权诉讼</p>
<p>“人民版权”首创“梯度化司法综合服务”。面向数字版权维权需求，“人民版权”提供了一套创新司法服务，形成了包含互联网法院、公证、司法鉴定、律师、仲裁为一体的权威司法梯度化服务体系，为版权保护在数权时代的司法维权奠定坚实基础。</p>
<p>此外，与传统的维权模式相比，“人民版权”采用电子证据管理、线上调解、互联网法院诉讼等新模式，以智能电子化代替传统人工模式降低成本，用传统版权服务1/2的价格便可完成确权、维权全流程，帮助用户以最小成本、最高效率维权，提升版权维权的司法效率。</p>
<p>今年初，“人民版权”还正式接入了北京互联网法院“天平链”电子证据平台，成为首个实现版权存证、侵权监测、线上版权交易、司法维权全链条打通的媒体版权平台。</p>
<p>媒体年交易额可达百万 打造线上最大版权交易平台</p>
<p>“人民版权”平台将版权交易环节引入线上。版权交易中心利用区块链技术对内容生产传播全流程的记录，能够进一步帮助媒体实现在信息分发链条上的价值再分配。据悉，线上引入交易环节，媒体单位版权交易年均收益额预估可达七百万元，市场效益可观。</p>
<p>目前，“人民版权”平台已经完成北京歌华有线电视网络股份有限公司、山东数字出版传媒有限公司、微众银行等五大一级节点接入。2019年10月，“北京云·融媒体”成为第一家接入“人民版权”的省级融媒体平台。同时，人民在线/人民网舆情数据中心发起的“人民版权联盟”已有100多家党媒正在对接中。</p>
<p>“人民版权”运用区块链、大数据与AI 识别等创新技术，即将实现视频版权保护功能。目前，“人民版权”正在与西部国家版权交易中心、北方国家版权交易中心、中广电传媒有限公司等进行视频版权方面的合作，携手共促视频版权生态的良性发展。</p>
<p>经济效益<br>FISCO BCOS助力深圳破解网贷良性退出难题<br>虽然区块链技术热度方兴，而深圳已经成功应用于网贷机构良性退出工作中。记者昨日从深圳地方金融监管局获悉，今年上半年，深圳率先全国推出以区块链技术为核心的P2P网贷机构良性退出统一投票表决系统，至今已在全市20家网贷机构投入应用，导入出借人8万余人，待收本金102亿余元。</p>
<p>投票系统让万千出借人有了“表决权”</p>
<p>面对网贷机构退出的兑付方案，普通出借人如何表达自己的意见和诉求？今年上半年，在深圳市、区两级地方金融监管部门的指导和推动下，深圳率先全国推出P2P网贷机构良性退出统一投票表决系统（下称“投票系统”）。</p>
<p>该系统是《深圳市网络借贷信息中介机构良性退出指引》（下称《良性退出指引》）的配套技术支持平台，旨在有效解决平台良性退出过程中涉众决策难的问题，为网贷良性退出工作打响了“开山炮”。</p>
<p>“P2P网贷机构良性退出面临的首要难题是涉众决策难。”深圳市互联网金融协会秘书长曾光介绍，网贷机构管理的资产权属属于出借人，但出借人数量庞大，分布在全国各地，结构复杂诉求不一，平台与出借人沟通成本高、出借人对平台不信任。</p>
<p>为提供涉众决策统一规则，深圳市互联网金融协会率先推出《良性退出指引》，创新设置出借人监督委员会、“三分之二加双过半”的表决规则等一系列良性退出规则要求。</p>
<p>在《良性退出指引》基础上，再度推出“网贷机构投票系统”，使涉及出借人重大利益事项的投票表决成为可能。“在以前的出借人表决实际操作中，往往通过微信群、QQ群、社交网站的投票软件，少数代表的现场会等形式进行投票，其合法性和公正性倍受质疑，执行过程也常有反复。”曾光介绍，在此情况下，新的投票系统为出借人提供投票表决服务，致力于实现公平、公开、透明的投票表决环境。出借人监督委员会负责对相关事项进行审核监督，网贷机构授权协会提供信息披露及投票表决服务。</p>
<p>记者了解到，目前深圳市已经有20家网贷机构使用投票系统。曾光介绍，“使用投票系统的大部分网贷机构都按照《退出指引》要求，积极推动了第一次重大事项投票表决，确认退出流程，选举监委会成员并对清退组和监委会授权。”另外部分平台已通过投票系统完成第二轮投票表决事项，各平台的良性退出工作进展有序。</p>
<h3 id="尚需深入研究的问题"><a href="#尚需深入研究的问题" class="headerlink" title="尚需深入研究的问题"></a>尚需深入研究的问题</h3><p>在区块链系统和业务设计时，不信任什么。</p>
<p>先讲结论： 几乎什么都不能信！建立Don’t Trust,Just Verify的理念，才是通往区块链世界的正确态度。</p>
<p>不信任其他节点<br>区块链节点和其他节点会建立P2P通信，共同组成网络，传递区块、交易、共识信令等各种信息。其他节点可能是由不同的机构、不同的人持有，持有节点的人可能是善意，也可能是恶意。即使在善意假设时，节点运行存活的健康度也会受运维水平和资源影响，比如处于一个不稳定的网络里，会偶尔挂掉，会抽风乱发消息，或者硬盘满等原因导致数据存储失败，以及出现其他可能的故障。在恶意假设时，要预设其他节点可能会骗自己或伤害自己，比如传递过来错误的协议包，或者用诡异的指令寻找漏洞进行攻击，或者发起高频垃圾请求，频繁连接然后断开，又或者海量连接占用资源等。</p>
<p>所以节点应该是把自己看成在黑暗丛林里孤身求生存的猎人，必须有“独立自主”、“自给自足”的态度，摆出“不相信其他任何节点”的姿势保护自己。在节点准入时，需要采用证书技术来认证节点身份；在连接控制上，拒绝有异常的连接；采用频率控制对连接次数、请求量等做限制；在协议包格式和指令正确性等方面做验证。自己发出去的信息，不应暴露自己的私有信息，也不期望其他节点一定会给出立刻和正确的响应，必须采用异步处理和校验容错的设计。</p>
<p>节点和客户端互相不信任<br>客户端，指在区块链网络外，向区块链发起请求的模块，如业务使用的java sdk、钱包客户端等。客户端和节点通过网络端口通信。如果客户端掌握在不受控的人手里，有可能会向节点发起大量的请求，或发送一堆垃圾信息，使节点疲于应对，甚至巧妙地构建漏洞攻击信息，试图越权访问，窃取信息或使节点出错。</p>
<p>同时，从客户端的角度看，节点有可能不响应或响应缓慢，或者返回错误的数据，包括格式错误、状态错误、表示收妥但其实不处理等，甚至别有用心的人会设置一个“假”节点和客户端通信，欺骗客户端。节点做出这些与期望不符的反应，可能使客户端运行出错，功能受损。</p>
<p>为提升节点和客户端的互信，可以为双方分配数字证书，必须通过证书进行双向握手，客户端经过私钥签名才能对节点发起交易类请求，节点应对客户端进行权限控制，拒绝高危的接口调用，不要轻易开放节点管理接口、系统配置接口等。双方对每次通信的数据格式、数据有效性都进行严密校验。双方在交互时也应该进行频率控制，异步处理，对每一个交互进行结果校验，不能预设对方正确处理，必须获取交易回执和处理结果进行确认。</p>
<p>当认为只和一个节点通信并不能保证安全时，客户端可以采用“f+1查询”的思路，尽可能多地和几个节点通信。如果当前链的共识安全模型是“3f+1”，那么，如果从f+1个节点读到的信息是一致的，结果是可以确认的。</p>
<p>不信任区块高度<br>区块高度是一个非常关键的信息，代表整个链当前的状态。向区块链发送交易、节点间进行共识、对区块和状态的校验等操作都会依赖区块高度。</p>
<p>某个节点在断网或处理速度缓慢时，其区块高度有可能落后于整个链，又或者某个节点恶意伪造数据时，其高度又可能超过整个链。在链出现分叉时，如某一个分叉上的区块高度被另一个分叉超越，落后的分叉就会变得毫无意义。即使在正常的情况下，节点依旧有可能间歇性地落后于整个链一到几个区块，然后在一定时间内才可能追上最新高度。</p>
<p>如在PBFT共识模型里，总数2/3以上节点在同一个高度时，全链就有机会达成共识继续出块。余下的1/3的节点有可能和参与共识的节点高度不同，这时意味着从这个节点读取到的数据，并不是全网最新的数据，只能代表链在该高度时的一个快照。</p>
<p>业务逻辑可以把区块高度做为一个参考值，基于高度做一些判定逻辑，在确定性共识（如PBFT）的链上，采用f+1查询等方法确认链的最新高度，在可能分叉的链上，需要参考“6个区块确认”的逻辑，审慎选取可信的区块高度。</p>
<p>不信任交易数据<br>交易（Transaction）代表一方向另一方发起了一个事务请求，交易可能导致资产的转移、改变帐户状态或系统配置，区块链系统通过共识后确认交易，使相关的事务生效。交易必须带上发送者的数字签名，交易里所有数据字段都必须包含在签名里，未经签名的字段存在被伪造的可能，不予采信。交易数据在网络上广播时，可以被其他人读取，如交易数据里包含隐私数据，发送者则必须对数据进行脱敏或加密保护。交易可能因为网络原因被重发，或者被其他人保存下来刻意再次发送，造成交易的“重放”，所以区块链系统必须对交易进行防重，避免出现“双花”。</p>
<p>不信任状态数据<br>区块链的状态（State）数据是由智能合约运行后生成的，理想情况下，每个节点的合约引擎一致、输入一致、规则一致，那么输出的状态就应该一致。但不同的节点可能安装了不同的软件版本，或者合约引擎的沙盒机制不够严密引入了不确定性因素，甚至被侵入、篡改，或者存在其他莫名其妙的bug，都可能导致合约运行输出结果不一致，那么一致性和事务性就无法得到保障。</p>
<p>状态的校验是成本很高的事情，典型的校验方法是使用MPT（Merkle Patricia Tree）树，把所有状态都塞到树里管理起来。MPT树可以把所有的状态归结为一个Merkleroot Hash，节点之间在共识过程中确认交易运行后生成的状态树Merkleroot，确保状态一致。</p>
<p>这棵树结构复杂，数据量大，消耗不少的计算和存储资源，很容易就成为了性能瓶颈。所以对状态的校验需要有更快、更简单，且又稳妥的方案，如结合版本验证、增量Hash验证等算法，辅以数据缓存，可减少重复计算和优化IO次数，能在保证一致性、正确性的同时，有效地提升验证效率。</p>
<p>不信任私钥持有者<br>采用私钥对交易以及其他关键操作进行签名，再使用公钥验签，是区块链上最基础的验证逻辑。只要私钥被正确使用，这个逻辑是安全的。</p>
<p>但私钥仅仅是一段数据，只依赖私钥则用户是匿名的。在联盟链面对的场景里，需要使用许可型的身份，首先通过KYC、尽调、权威认证等现实世界的验证方式确认身份，然后将身份和公钥绑定并公示，或者结合PKI体系的数字证书发放公私钥，这样私钥对应的身份是可知、可信、可控的。</p>
<p>私钥可能会因丢失、泄漏而被他人盗用，或者因被遗忘导致资产损失。所以在私钥的保存上，需要考虑采用周全的保护方案，如加密存储、TEE环境、密码卡、USBkey、软硬加密机等方案。在私钥的管理上，则需要考虑密钥丢失后如何安全的重置、找回。</p>
<p>加强版的私钥使用思路有几个，比如使用多签、门限签名等方式，每次交易时必须用多个私钥进行签名，私钥可以保管在不同的地方，安全性高，但技术方案和使用体验复杂。</p>
<p>还有一种是交易私钥和管理私钥分离。交易私钥用于管理资产，管理私钥用于管理个人资料，交易私钥可以被管理私钥重置，管理私钥本身则通过门限、分片等算法，分开存储保管，以备重置或找回。</p>
<p>不信任其他链<br>在跨链的场景里，每条链有自己的资产、共识，链之间的安全模型变得非常复杂，比如一条链上的记账者串通造假，或者链出现了分叉、区块高度回滚，这时如果链外的其他模块和链有不够严谨的交互，都会造成数据不一致或资产损失。如果不同的链采用的还是不一样的平台架构，那么在工程上会更加复杂。</p>
<p>跨链、侧链目前依旧是业界在研究和逐步实现的课题，主要目的是解决链和链之间的通信，进行资产锁定和资产交换，保证整个过程的全局一致性、交易事务性，以及抗欺诈。从A链往B链转移一个资产，必须要确保A链上的资产被锁定或销毁，且B链上一定能增加对应的一笔资产，在双方可能分别出现分叉、回滚的时间窗里，要有机制确保双向的资产安全。</p>
<p>在现有跨链的方案里，存在中继、链间HUB等方式，这些系统的设计本身也要达到高度可信可靠的标准，安全等级应不低于甚至高于所对接的链，同样也应采用多中心、群体共识的体系设计，整体复杂度可算是链的N次方了。</p>
<p>不信任网络层<br>区块链节点需要和其他节点发生通信，所以必须在网络上暴露自己的通信端口，如果通过公网通信，那么相当于在公网上暴露了自己，很容易遭到类似渗透、DDOS这样的网络攻击。节点必须在网络层保护自己，包括在网关上设置IP黑白名单、设置端口策略、进行DDOS流量防护，且对网络流量、网络状态进行监测，如果突发网络流量或连接数暴增，说不定，就是被人当肉鸡或者正在脱库进行时了。非必要端口，切忌对公网开放，如用于做管理监控的RPC端口，只能对机构内部开放，在进行网络策略设定之前，一定要慎之又慎。</p>
<p>不信任代码<br>“Code is law”确实是一句响亮的口号，但是在程序员头发掉光之前，他写的代码都可能有bug，只是看写bug快还是修bug快而已。</p>
<p>无论是底层的代码还是智能合约代码，都可能存在技术性或逻辑性的坑，但凡代码产生的数据和指令行为，都需要另一段代码对其进行严格地校验，代码本身也需要进行静态和动态扫描，包括采用形式化证明等技术进行全面地审核验证，以检测可能的逻辑错误、安全漏洞或是否有信息泄露。前段时间有一份公布到github上的某酒店系统的代码，居然包括了mysql的连接用户名密码，且数据库端口居然是向公网开放的，这种坑简直不可想象。</p>
<p>开放出去的开源代码，固然可以被人审查、反馈以提升安全性，也可能被人翻找漏洞、随意修改，甚至恶意埋雷。但总的来说，开源还是利大于弊。在开源社区中，开发者会向项目提交PR（Pull Request）。审核PR是很关键也很繁重的工作，值得安排专家并分配大量时间去做审核。有开源项目的老司机透露，其项目核心模块的PR的审核时间长达经年，否则“加了个功能引入两个bug”那真是得不偿失，更别说如果被植入漏洞埋雷了。</p>
<p>不信任记账者<br>共识的流程大致可以抽象为，选出记账者，记账者发布区块，其他节点校验和确认。公链里记账可以用“挖矿”的方式进行（如比特币），矿工用大量的算力代价为它自己的诚信背书，又或者是用大量的资产权益抵押获得记账权（Pos和DPos等共识）。在联盟链常用的PBFT/Raft等算法里，记账者列表可以是随机或轮换产生，记账者给出提案，其他投票人多步提交，收集投票。按少数服从多数的原则，一般是2/3以上共识节点同意，共识才能达成。</p>
<p>从系统可用性角度看，记账者有可能出错、崩溃，或者运行缓慢，影响整个链的出块。又或者记账者可以只收录手续费高的交易，抛弃一些交易，导致有些交易总是不能达成。有的记账者还可以凭借算力或暗箱运作，进行“预挖”或者“扣块攻击”，破坏博弈关系……</p>
<p>记账者故障或作恶，超越了共识的安全阈值的话，将直接伤害整条链的价值基础。根据不同的记账模式，记账者需要设计不同的容错、校验、抗欺诈算法，执行激励和惩罚机制，在运行过程中定期检查记账者的健康度，对于无力记账或者作恶的记账节点，全网不接受他们的记账结果，并对其进行惩戒，甚至是踢出网络。</p>
<p>罗列起来还有很多，包括合约、证书、同步等等，每一个模块都有自己的功用和风险点，简直罄竹难书。总之，区块链做为分布式的多方协作的体系，接入了形形色色参与者，整个体系绝不是单个开发者或运营者所能单点把控，“善意推测”在这个领域已经不尽适用，整个世界步步惊心，处处冷箭，只能通过周密的算法和繁杂的流程维系共识和安全，简而言之，没有经过验证的信息，一个字节都不能相信。</p>
<p>比起单一环境里的软件设计，区块链领域的设计思路确实存在颠覆性，开发者要从“做功能，只容错，不防骗”的思维模式里跳出来，带着“怀疑一切”的态度进行设计。</p>
<p>开发者在面向区块链领域时，不能只是思考怎么实现一个功能，而更要去思考整个流程会不会有出错，会不会被人篡改数据、发掘漏洞、攻击系统、欺诈其他参与者。要换位思考自己所实现的功能，会被别人用什么方式使用，在不同的环境会有什么表现，可能造成什么后果。任何收到的信息，任何流程输入、输出，都必须经过严格地校验才能采信，开发者能做到这一点，才算是打开了区块链新世界的大门，才能在连续剧里至少活到第二集。</p>
<p>分布式算法、对称非对称加密、HASH、证书、安全和隐私等技术在区块链领域大行其道，都是为了在保护信息的同时，给信息加上一层又一层的证明和可验证因子，这使得整个系统变得复杂、繁琐，但这是值得的，因为这样才能共同验证，构建“安全”和“信任”。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://yuzhang.wang">YuZhangWang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://yuzhang.wang/094-blockchain/">https://yuzhang.wang/094-blockchain/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://yuzhang.wang" target="_blank">YuZhangWang的领域</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MacOS/">MacOS</a><a class="post-meta__tags" href="/tags/%E9%BB%91%E8%8B%B9%E6%9E%9C/">黑苹果</a><a class="post-meta__tags" href="/tags/Ubuntu/">Ubuntu</a><a class="post-meta__tags" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/">区块链</a><a class="post-meta__tags" href="/tags/%E5%88%9B%E6%96%B0/">创新</a></div><div class="post_share"></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418195242695.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418195242695.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li><li class="reward-item"><a href="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418195556282.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418195556282.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/095-colorful-painting/" title="基于Opencv实现的多彩隔空画图"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210824171559.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">基于Opencv实现的多彩隔空画图</div></div></a></div><div class="next-post pull-right"><a href="/093-moscow/" title="《莫斯科不相信眼泪》"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/08/07/20220807052220734.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">《莫斯科不相信眼泪》</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/066-black-apple/" title="黑苹果安装方法"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/08/07/20220807050838325.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-28</div><div class="title">黑苹果安装方法</div></div></a></div><div><a href="/029-farewell-microsoft/" title="告别微软计划"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/08/07/20220807043317192.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-15</div><div class="title">告别微软计划</div></div></a></div><div><a href="/043-arm-architecture/" title="ARM架构"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/08/07/20220807044638728.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-23</div><div class="title">ARM架构</div></div></a></div><div><a href="/097-blackapple/" title="黑苹果,浏览器,系统"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202208070525320.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-07</div><div class="title">黑苹果,浏览器,系统</div></div></a></div><div><a href="/079-vim-experience/" title="Vim初体验"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210826225745.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-23</div><div class="title">Vim初体验</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202210171416164.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">YuZhangWang</div><div class="author-info__description">PLUSULTRA!</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">134</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">262</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">22</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:YuZhangWang233@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://github.com/YuZhangWang" target="_blank" title="Github"><i class="fab fa-github" style="color: ;"></i></a><a class="social-icon" href="https://space.bilibili.com/19474542" target="_blank" title="bilibili"><i class="fab fa-bilibili" style="color: #FB7299;"></i></a><a class="social-icon" href="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative_pictures01@main/2021/03/09/mmqrcode1615295634051.png" target="_blank" title="WeChat"><i class="fab fa-weixin" style="color: #199D18;"></i></a><a class="social-icon" href="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative_pictures01@main/2021/03/09/qrcode_1615295622746.jpg" target="_blank" title="QQ"><i class="fab fa-qq" style="color: #4AABE7;"></i></a><a class="social-icon" href="https://yuzhang.wang/rss2.xml" target="_blank" title="RSS"><i class="fa-solid fa-rss" style="color: #F99C36;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">1.视频发布于B站，文章发布于博客</br> 2.待修复bug:无</br> 3.待优化地方:</br> 使用Github action自动化部署网站</br></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%A1%B9%E7%9B%AE%E4%B8%BB%E8%A6%81%E5%86%85%E5%AE%B9"><span class="toc-text">一、项目主要内容</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%8C%BA%E5%9D%97%E9%93%BE%EF%BC%9F"><span class="toc-text">什么是区块链？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BA%E5%9D%97%E9%93%BE%E5%8E%9F%E7%90%86"><span class="toc-text">区块链原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%8C%BA%E5%9D%97%E6%9C%89%E5%85%B3%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-text">一些区块有关的问题：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%B8%A4%E7%B1%BB%E5%86%9B%E9%97%AE%E9%A2%98"><span class="toc-text">(1)两类军问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89%E6%8B%9C%E5%8D%A0%E5%BA%AD%E5%B0%86%E5%86%9B%E9%97%AE%E9%A2%98"><span class="toc-text">(2）拜占庭将军问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%A5%B3%E5%B7%AB%E6%94%BB%E5%87%BB"><span class="toc-text">(3)女巫攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96%E7%9A%84%E7%BB%8F%E6%B5%8E%E9%9D%A9%E5%91%BD%E4%B8%8E%E5%8C%BA%E5%9D%97%E9%93%BE%E7%9A%84%E5%89%8D%E6%99%AF%EF%BC%9A"><span class="toc-text">去中心化的经济革命与区块链的前景：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%8F%E6%B5%8E%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96"><span class="toc-text">经济去中心化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%8B%E4%BA%88%E6%9C%BA%E5%99%A8%E6%80%9D%E8%80%83%E7%9A%84%E5%8A%9B%E9%87%8F"><span class="toc-text">赋予机器思考的力量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BD%E5%86%85%E5%9B%BD%E5%A4%96%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF%E7%A0%94%E7%A9%B6%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98%E4%B8%8E%E6%9C%AA%E6%9D%A5%E7%A0%94%E7%A9%B6%E6%96%B9%E5%90%91%E4%B8%8E%E6%96%B9%E5%BC%8F"><span class="toc-text">国内国外区块链技术研究存在的问题与未来研究方向与方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-text">问题:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E5%90%91"><span class="toc-text">方向:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%9F%BA%E4%BA%8E%E6%83%85%E5%86%B5"><span class="toc-text">项目基于情况</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%96%BD%E6%83%85%E5%86%B5%E6%80%BB%E7%BB%93"><span class="toc-text">二、项目实施情况总结</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%96%BD%E6%83%85%E5%86%B5"><span class="toc-text">1.项目实施情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%A1%B9%E7%9B%AE%E7%A0%94%E7%A9%B6%E5%86%85%E5%AE%B9%E5%8F%8A%E6%96%B9%E6%B3%95%E7%9A%84%E5%88%9B%E6%96%B0"><span class="toc-text">2.项目研究内容及方法的创新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%A0%94%E7%A9%B6%E5%86%85%E5%AE%B9"><span class="toc-text">项目研究内容</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%8A%9F%E8%83%BD%E8%A7%86%E8%A7%92"><span class="toc-text">(1)功能视角</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E7%B3%BB%E7%BB%9F%E8%A7%86%E8%A7%92"><span class="toc-text">(2)系统视角</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%94%A8%E6%88%B7%E8%A7%86%E8%A7%92"><span class="toc-text">(3)用户视角</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%BC%80%E5%8F%91%E8%A7%86%E8%A7%92"><span class="toc-text">(4)开发视角</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Python-API%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-text">(5)Python API的安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-API%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-text">(6)API的安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E8%BF%9B%E5%85%A5%E6%BA%90%E7%A0%81%E5%B9%B6%E4%B8%94%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83"><span class="toc-text">(7)进入源码并且创建虚拟环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E5%8C%BA%E5%9D%97%E9%93%BE%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA"><span class="toc-text">(8)区块链网络搭建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E7%94%9F%E6%88%90%E6%90%AD%E5%BB%BA%E5%B7%A5%E4%BD%9C"><span class="toc-text">(9)生成搭建工作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E7%94%9F%E6%88%90FISCO%E9%93%BE"><span class="toc-text">(10)生成FISCO链</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E5%90%AF%E5%8A%A8"><span class="toc-text">(11)启动</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E8%BF%9B%E7%A8%8B%E6%A3%80%E6%9F%A5"><span class="toc-text">(12)进程检查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-%E8%8A%82%E7%82%B9%E5%AE%9E%E6%97%B6%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81%E6%A3%80%E6%9F%A5"><span class="toc-text">(13)节点实时运行状态检查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-%E6%8E%A7%E5%88%B6%E5%8F%B0%E9%83%A8%E7%BD%B2"><span class="toc-text">(14)控制台部署</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-%E9%85%8D%E7%BD%AE%E6%8E%A7%E5%88%B6%E5%8F%B0%E4%BF%A1%E6%81%AF"><span class="toc-text">(15)配置控制台信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-%E5%90%AF%E5%8A%A8%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-text">(16)启动控制台</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-WEBASE-Front%E8%8A%82%E7%82%B9%E7%9A%84%E6%90%AD%E5%BB%BA"><span class="toc-text">(17)WEBASE-Front节点的搭建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-%E6%A3%80%E6%9F%A5%E8%8A%82%E7%82%B9%E8%BF%9B%E7%A8%8B"><span class="toc-text">(18)检查节点进程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#19-%E6%A3%80%E6%9F%A5%E7%AB%AF%E5%8F%A3%E8%BF%9B%E7%A8%8B"><span class="toc-text">(19)检查端口进程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#20-%E6%9F%A5%E7%9C%8B%E8%BF%90%E8%A1%8C%E6%97%A5%E5%BF%97"><span class="toc-text">(20)查看运行日志</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#21-%E5%9B%BE%E5%BD%A2%E5%8C%96%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="toc-text">(21)图形化控制台</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#22-%E7%9B%91%E6%8E%A7%E6%9F%A5%E7%9C%8B"><span class="toc-text">(22)监控查看</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#23-%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BA%A4%E4%BA%92"><span class="toc-text">(23)实现数据的交互</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#24-%E6%96%B0%E5%BB%BA%E7%94%A8%E6%88%B7%EF%BC%8C%E9%83%A8%E7%BD%B2%E5%90%88%E7%BA%A6"><span class="toc-text">(24)新建用户，部署合约</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#25-%E6%B7%BB%E5%8A%A0%E5%85%AC%E5%8F%B8"><span class="toc-text">(25)添加公司</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#26-%E6%B7%BB%E5%8A%A0%E9%93%B6%E8%A1%8C"><span class="toc-text">(26)添加银行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#27-%E8%A1%8C%E5%90%91%E5%8F%97%E4%BF%A1%E5%85%AC%E5%8F%B8%E6%8E%88%E6%9D%83%E4%BF%A1%E7%94%A8%E8%B5%84%E4%BA%A7"><span class="toc-text">(27)行向受信公司授权信用资产</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#28-%E5%85%AC%E5%8F%B8A%E5%90%91%E5%85%AC%E5%8F%B8B%E8%BD%AC%E7%A7%BB%E4%BF%A1%E7%94%A8%E8%B5%84%E4%BA%A7%EF%BC%9A"><span class="toc-text">(28)公司A向公司B转移信用资产：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#29-%E9%93%B6%E8%A1%8C%E7%BB%99%E4%BA%88%E5%85%AC%E5%8F%B8%E7%9C%9F%E5%AE%9E%E8%B5%84%E9%87%91"><span class="toc-text">(29)银行给予公司真实资金</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#30-%E5%8F%97%E4%BF%A1%E5%85%AC%E5%8F%B8%E5%90%91%E9%93%B6%E8%A1%8C%E8%BF%98%E6%AC%BE"><span class="toc-text">(30)受信公司向银行还款</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#31-%E5%8F%97%E4%BF%A1%E5%85%AC%E5%8F%B8%E5%90%91%E9%93%B6%E8%A1%8C%E7%A1%AE%E8%AE%A4%E5%AE%8C%E6%88%90%E6%9C%AC%E6%AC%A1%E4%BA%8B%E5%8A%A1"><span class="toc-text">(31)受信公司向银行确认完成本次事务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E5%88%9B%E6%96%B0"><span class="toc-text">方法创新</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AD%98%E5%82%A8%E8%AE%BE%E8%AE%A1"><span class="toc-text">(1)存储设计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%B2%E8%A3%81%E6%9C%BA%E6%9E%84%EF%BC%9A"><span class="toc-text">仲裁机构：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%93%B6%E8%A1%8C%EF%BC%9A"><span class="toc-text">银行：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%AC%E5%8F%B8%EF%BC%9A"><span class="toc-text">公司：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E6%8D%AE%EF%BC%9A"><span class="toc-text">单据：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%88%E7%BA%A6%E4%B8%AD%E5%85%B6%E4%BB%96%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%EF%BC%9A"><span class="toc-text">合约中其他数据结构：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE"><span class="toc-text">(2)数据流图</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%A1%E7%94%A8%E8%B5%84%E4%BA%A7creditAsset%E7%9A%84%E6%B5%81%E9%80%9A%E6%9C%BA%E5%88%B6%EF%BC%9A"><span class="toc-text">信用资产creditAsset的流通机制：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9C%9F%E5%AE%9E%E8%B5%84%E9%87%91realMoney%E7%9A%84%E6%B5%81%E9%80%9A%E6%9C%BA%E5%88%B6%EF%BC%9A"><span class="toc-text">真实资金realMoney的流通机制：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%A0%B8%E5%BF%83%E5%88%9B%E6%96%B0%E5%8A%9F%E8%83%BD"><span class="toc-text">(3)核心创新功能</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%88%E7%BA%A6%E5%88%9D%E5%A7%8B%E5%8C%96%EF%BC%9A"><span class="toc-text">合约初始化：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%85%AC%E5%8F%B8%EF%BC%9A"><span class="toc-text">添加公司：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E9%93%B6%E8%A1%8C%EF%BC%9A"><span class="toc-text">添加银行：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E5%8D%95%E6%8D%AE%EF%BC%88%E5%86%85%E9%83%A8%E6%96%B9%E6%B3%95%EF%BC%89"><span class="toc-text">创建新单据（内部方法）:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%93%B6%E8%A1%8C%E5%90%91%E5%8F%97%E4%BF%A1%E5%85%AC%E5%8F%B8%E6%8E%88%E6%9D%83%E4%BF%A1%E7%94%A8%E8%B5%84%E4%BA%A7%EF%BC%9A"><span class="toc-text">银行向受信公司授权信用资产：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%AC%E5%8F%B8A%E5%90%91%E5%85%AC%E5%8F%B8B%E8%BD%AC%E7%A7%BB%E4%BF%A1%E7%94%A8%E8%B5%84%E4%BA%A7%EF%BC%9A"><span class="toc-text">公司A向公司B转移信用资产：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%93%B6%E8%A1%8C%E7%BB%99%E4%BA%88%E5%85%AC%E5%8F%B8%E7%9C%9F%E5%AE%9E%E8%B5%84%E9%87%91%EF%BC%9A"><span class="toc-text">银行给予公司真实资金：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%97%E4%BF%A1%E5%85%AC%E5%8F%B8%E5%90%91%E9%93%B6%E8%A1%8C%E8%BF%98%E6%AC%BE%EF%BC%9A"><span class="toc-text">受信公司向银行还款：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%97%E4%BF%A1%E5%85%AC%E5%8F%B8%E5%90%91%E9%93%B6%E8%A1%8C%E7%A1%AE%E8%AE%A4%E5%AE%8C%E6%88%90%E6%9C%AC%E6%AC%A1%E4%BA%8B%E5%8A%A1%EF%BC%9A"><span class="toc-text">受信公司向银行确认完成本次事务：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E6%9F%A5%E8%AF%A2%E9%93%BE%E4%B8%8A%E4%BF%A1%E6%81%AF%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-text">一些查询链上信息的方法：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E9%A1%B9%E7%9B%AE%E6%88%90%E6%9E%9C%E7%9A%84%E5%AD%A6%E6%9C%AF%E4%BB%B7%E5%80%BC"><span class="toc-text">3.项目成果的学术价值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%85%B1%E8%AF%86%E7%AE%97%E6%B3%95"><span class="toc-text">(1)共识算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="toc-text">(2)智能合约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AF%B9%E7%AD%89%E7%BD%91%E7%BB%9C"><span class="toc-text">(3)对等网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BA%A4%E6%98%93%E5%B9%B6%E8%A1%8C"><span class="toc-text">(4)交易并行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%A1%B9%E7%9B%AE%E6%88%90%E6%9E%9C%E7%9A%84%E7%A4%BE%E4%BC%9A%E6%95%88%E7%9B%8A%E5%92%8C%E7%BB%8F%E6%B5%8E%E6%95%88%E7%9B%8A%EF%BC%8C%E5%B0%9A%E9%9C%80%E6%B7%B1%E5%85%A5%E7%A0%94%E7%A9%B6%E7%9A%84%E9%97%AE%E9%A2%98%E7%AD%89"><span class="toc-text">4.项目成果的社会效益和经济效益，尚需深入研究的问题等</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BE%E4%BC%9A%E6%95%88%E7%9B%8A"><span class="toc-text">社会效益</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%89%93%E9%80%A0%E5%85%A8%E5%9C%BA%E6%99%AF%E9%80%8F%E6%98%8E%E7%AE%A1%E7%90%86%EF%BC%8C%E5%BB%BA%E4%BF%A1%E7%AD%91%E5%92%8C%E8%81%94%E6%89%8BFISCO-BCOS%E5%8A%A9%E5%8A%9B%E5%BB%BA%E9%80%A0%E4%B8%9A%E6%95%B0%E5%AD%97%E5%8C%96"><span class="toc-text">(1)打造全场景透明管理，建信筑和联手FISCO BCOS助力建造业数字化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E2%80%9C%E4%BA%BA%E6%B0%91%E7%89%88%E6%9D%83%E2%80%9D%E5%AD%98%E8%AF%81%E5%8E%9F%E5%88%9B%E6%96%B0%E9%97%BB%E8%B6%85200%E4%B8%87%E7%AF%87-FISCO-BCOS%E5%BA%94%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="toc-text">(2)“人民版权”存证原创新闻超200万篇 | FISCO BCOS应用案例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%9A%E9%9C%80%E6%B7%B1%E5%85%A5%E7%A0%94%E7%A9%B6%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">尚需深入研究的问题</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/134-past-pesent-future/" title="过去 现在 未来"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202306221915786.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="过去 现在 未来"/></a><div class="content"><a class="title" href="/134-past-pesent-future/" title="过去 现在 未来">过去 现在 未来</a><time datetime="2023-06-08T00:08:08.000Z" title="发表于 2023-06-08 08:08:08">2023-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/133-best-template/" title="你应该为自己创建一个Github仓库模板"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202306221850169.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="你应该为自己创建一个Github仓库模板"/></a><div class="content"><a class="title" href="/133-best-template/" title="你应该为自己创建一个Github仓库模板">你应该为自己创建一个Github仓库模板</a><time datetime="2023-06-07T00:08:08.000Z" title="发表于 2023-06-07 08:08:08">2023-06-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/132-github-introduction/" title="如何拥有一个Awesome的Github介绍页面"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202306221849724.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何拥有一个Awesome的Github介绍页面"/></a><div class="content"><a class="title" href="/132-github-introduction/" title="如何拥有一个Awesome的Github介绍页面">如何拥有一个Awesome的Github介绍页面</a><time datetime="2023-06-06T00:08:08.000Z" title="发表于 2023-06-06 08:08:08">2023-06-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/131-remote-friend-linking/" title="Butterfly主题中远程友链实操"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202306221846685.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Butterfly主题中远程友链实操"/></a><div class="content"><a class="title" href="/131-remote-friend-linking/" title="Butterfly主题中远程友链实操">Butterfly主题中远程友链实操</a><time datetime="2023-06-05T00:08:08.000Z" title="发表于 2023-06-05 08:08:08">2023-06-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/130-domain-name-issue/" title="域名的小问题导致网站关闭了很久"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202306221845754.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="域名的小问题导致网站关闭了很久"/></a><div class="content"><a class="title" href="/130-domain-name-issue/" title="域名的小问题导致网站关闭了很久">域名的小问题导致网站关闭了很久</a><time datetime="2023-06-04T00:08:08.000Z" title="发表于 2023-06-04 08:08:08">2023-06-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/129-genshin-progress-planning/" title="原神进度以及未来规划"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202306221844655.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="原神进度以及未来规划"/></a><div class="content"><a class="title" href="/129-genshin-progress-planning/" title="原神进度以及未来规划">原神进度以及未来规划</a><time datetime="2023-06-03T00:08:08.000Z" title="发表于 2023-06-03 08:08:08">2023-06-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="footer_custom_text"><div class="copyright">Created by <a href="https://github.com/YuZhangWang" target="_blank">YuZhangWang</a>&nbsp;<i class="fa-fw fas fa-heart card-announcement-animation cc_pointer"></i>&nbsp;©2019-Present&nbsp;&nbsp;|&nbsp;&nbsp;Powered By <a href="https://hexo.io/zh-cn/index.html" target="_blank">Hexo</a>&nbsp;&nbsp;|&nbsp;&nbsp;Theme By <a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank">Butterfly</a></div><div align="center"><a href="https://qwerty.kaiyi.cool/" target="_blank" alt="qwerty-learner" rel="nofollow"> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202305131945636.png" alt="qwerty-learner" style="height:1.3em"></a>&nbsp;<a href="https://blogwe.com/" target="_blank" alt="博客大全" rel="nofollow"> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418195801782.jpg" alt="博客大全" style="height:1.3em"></a>&nbsp;<a href="https://travellings.pages.dev" target="_blank" alt="开往" rel="nofollow"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418195840939.jpg" alt="开往" style="height:1.3em"></a>&nbsp;<a href="https://vim-adventures.com/" target="_blank" alt="vim-adventures" rel="nofollow"> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418195910376.jpg" alt="vim-adventures" style="height:1.3em"></a>&nbsp;<a href="http://restart.sshh.top/view/" target="_blank" alt="人生重开模拟器" rel="nofollow"> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418195940841.png" alt="人生重开模拟器" style="height:1.3em"></a>&nbsp;<a href="https://huanghaibin91.github.io/Reversi/" target="_blank" alt="黑白翻转棋" rel="nofollow"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02/2022/04/18/20220418200005401.png" alt="黑白翻转棋" style="height:1.3em"></a>&nbsp;<a href="https://cloud.tencent.com/" target="_blank" alt="腾讯云" rel="nofollow"> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures01@main/img/20210826081712.svg" alt="腾讯云" style="height:1.3em"></a>&nbsp;<a href="https://www.jsdelivr.com" target="_blank" alt="Jsdelivr" rel="nofollow"> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gcore.jsdelivr.net/gh/YuZhangWang/Creative-pictures02@master/img/202305131843411.png" alt="Jsdelivr" style="height:1.3em"></a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>function getGiscusTheme (theme) {
  return theme === 'dark' ? 'dark' : 'light'
}

function loadGiscus () {
  const config = Object.assign({
    src: 'https://giscus.app/client.js',
    'data-repo': 'YuZhangWang/YuZhangWang.github.io',
    'data-repo-id': 'MDEwOlJlcG9zaXRvcnkzNDY4MTQyNjE=',
    'data-category-id': 'DIC_kwDOFKv3Nc4CQ6NC',
    'data-mapping': 'pathname',
    'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
    'data-reactions-enabled': '1',
    crossorigin: 'anonymous',
    async: true
  },{"data-mapping":"title","data-strict":1,"data-reactions-enabled":1,"data-emit-metadata":0,"data-input-position":"top","data-lang":"zh-CN","data-loading":"lazy"})

  let ele = document.createElement('script')
  for (let key in config) {
    ele.setAttribute(key, config[key])
  }
  document.getElementById('giscus-wrap').insertAdjacentElement('afterbegin',ele)
}

function changeGiscusTheme (theme) {
  function sendMessage(message) {
    const iframe = document.querySelector('iframe.giscus-frame')
    if (!iframe) return
    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app')
  }

  sendMessage({
    setConfig: {
      theme: getGiscusTheme(theme)
    }
  });
}

btf.addModeChange('giscus', changeGiscusTheme)

if ('Giscus' === 'Giscus' || !true) {
  if (true) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
  else loadGiscus()
} else {
  function loadOtherComment () {
    loadGiscus()
  }
}</script></div><script src="https://myhkw.cn/api/player/162986644718" id="myhk" key="162986644718" m="1"></script><script>document.addEventListener('visibilitychange', function () {if (document.visibilityState == 'hidden') {normal_title = document.title;document.title = '早上好 中午好 晚上好';}else document.title = normal_title;});</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="177,225,255" opacity="1" zIndex="-1" count="111" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start --> <script data-pjax>if(document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    var parent = document.getElementById('recent-posts');
    var child = '<div class="recent-post-item" style="width:100%;height: auto"><div id="catalog_magnet"><div class="magnet_item"><a class="magnet_link" href="https://yuzhang.wang/categories/学术研究/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">🎓 Academic Research (11)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://yuzhang.wang/categories/项目展示/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">💎 Project Showcase (15)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://yuzhang.wang/categories/Python学习笔记/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📖 Python Learning Notes (1)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://yuzhang.wang/categories/CV学习笔记/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">💻 CV Learning Notes (9)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://yuzhang.wang/categories/C-学习笔记/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">📖 C++ Learning Notes (4)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><div class="magnet_item"><a class="magnet_link" href="https://yuzhang.wang/categories/数据结构学习笔记/"><div class="magnet_link_context" style=""><span style="font-weight:500;flex:1">💻 Data Structures Learning Notes (3)</span><span style="padding:0px 4px;border-radius: 8px;"><i class="fas fa-arrow-circle-right"></i></span></div></a></div><a class="magnet_link_more"  href="https://yuzhang.wang/categories" style="flex:1;text-align: center;margin-bottom: 10px;">查看更多...</a></div></div>';
    console.log('已挂载magnet')
    parent.insertAdjacentHTML("afterbegin",child)}
     </script><style>#catalog_magnet{flex-wrap: wrap;display: flex;width:100%;justify-content:space-between;padding: 10px 10px 0 10px;align-content: flex-start;}.magnet_item{flex-basis: calc(50% - 5px);background: #f2f2f2;margin-bottom: 10px;border-radius: 8px;transition: all 0.2s ease-in-out;}.magnet_item:hover{background: rgb(127, 199, 244)}.magnet_link_more{color:#555}.magnet_link{color:black}.magnet_link:hover{color:white}@media screen and (max-width: 600px) {.magnet_item {flex-basis: 100%;}}.magnet_link_context{display:flex;padding: 10px;font-size:16px;transition: all 0.2s ease-in-out;}.magnet_link_context:hover{padding: 10px 20px;}</style>
    <style></style><script data-pjax>function history_calendar_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span>历史上的今天</span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
                console.log('已挂载history_calendar')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='/'|| '/' ==='all')){

            history_calendar_injector_config()
        } </script><script data-pjax  src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>